{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"aoe2-genie-tooling","text":"<p>High-level Python toolkit for editing Age of Empires II Definitive Edition DAT files.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Object-Oriented API \u2013 Proper handle objects for Units, Graphics, Sounds</li> <li>Multi-Civ Propagation \u2013 Changes apply to all civilizations automatically</li> <li>Attribute Flattening \u2013 Access nested properties directly</li> <li>Type-Safe Datasets \u2013 IntEnum constants for resources, tasks, attack classes</li> </ul>"},{"location":"#quick-example","title":"Quick Example","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\n\n# Get managers\num = workspace.genie_unit_manager()\ngm = workspace.graphic_manager()\nsm = workspace.sound_manager()\n\n# Create a custom unit\nunit = um.create(\"Elite Guard\", base_unit_id=4)\nunit.hit_points = 120\nunit.max_range = 6.0\n\n# Create and assign graphics\nattack_gfx = gm.add_graphic(\"guard_attack.slp\", frame_count=15)\nunit.combat.attack_graphic = attack_gfx.id\n\nworkspace.save(\"output.dat\")\n</code></pre>"},{"location":"#installation","title":"Installation","text":"<pre><code>pip install aoe2-genie-tooling\n</code></pre>"},{"location":"#documentation","title":"Documentation","text":"<ul> <li>Getting Started \u2013 Installation and first steps</li> <li>Units API \u2013 Complete unit manipulation guide</li> <li>Graphics API \u2013 Graphics and deltas</li> <li>Examples \u2013 Real-world usage examples</li> </ul>"},{"location":"code_notes/","title":"Code Notes \u2013 aoe2-genie-tooling","text":"<p>Living documentation of Actual_Tools and Datasets packages.</p>"},{"location":"code_notes/#run-log","title":"Run Log","text":""},{"location":"code_notes/#2026-01-01-1810-utc2","title":"2026-01-01 18:10 UTC+2","text":"<ul> <li>Files reviewed:</li> <li><code>Actual_Tools/Units/unit_handle.py</code> (658 lines)</li> <li><code>Actual_Tools/Units/unit_manager.py</code> (441 lines)</li> <li><code>Actual_Tools/Units/handles.py</code> (407 lines, 6 handle classes)</li> <li><code>Actual_Tools/Units/wrappers/</code> (10 wrappers)</li> <li><code>Actual_Tools/Graphics/graphic_manager.py</code> (331 lines)</li> <li><code>Actual_Tools/Graphics/graphic_handle.py</code> (573 lines)</li> <li>Notes changes:</li> <li>Deep documentation of Units and Graphics modules</li> <li>Documented all handle and wrapper classes</li> <li>Captured method signatures and design patterns</li> </ul>"},{"location":"code_notes/#1-project-overview","title":"1. Project Overview","text":"<p>Purpose: High-level Python toolkit for editing AoE2 DE <code>.dat</code> files with object-oriented wrappers.</p> <p>Design principles: - Multi-civ propagation: Changes apply to all civilizations automatically - Attribute flattening: Access nested properties directly (<code>unit.move_sound</code> \u2192 <code>bird.move_sound</code>) - Handle pattern: Collection items return Handle objects with their index</p>"},{"location":"code_notes/#2-units-module","title":"2. Units Module","text":""},{"location":"code_notes/#21-unithandle-unitsunit_handlepy","title":"2.1 UnitHandle (<code>Units/unit_handle.py</code>)","text":"<p>Central accessor for unit data. Wraps one or more <code>genieutils.unit.Unit</code> objects.</p> <p>Constructor: <pre><code>UnitHandle(unit_id: int, dat_file: DatFile, civ_ids: Optional[List[int]] = None)\n</code></pre></p> <p>Core behavior: - <code>_get_units()</code> \u2013 Returns list of Unit objects for enabled civs (cached) - <code>_primary_unit</code> \u2013 First unit (reads come from here) - <code>__getattr__/__setattr__</code> \u2013 Flattens access through <code>_COMPONENTS = (\"bird\", \"dead_fish\", \"type_50\", \"projectile\", \"creatable\", \"building\")</code></p> <p>Wrapper properties (return wrapper objects): | Property | Wrapper Class | Source Component | |----------|---------------|------------------| | <code>.combat</code> | <code>Type50Wrapper</code> | <code>unit.type_50</code> | | <code>.creatable</code> | <code>CreatableWrapper</code> | <code>unit.creatable</code> | | <code>.cost</code> | <code>CostWrapper</code> | <code>unit.creatable.resource_costs</code> | | <code>.bird</code> | <code>BirdWrapper</code> | <code>unit.bird</code> | | <code>.dead_fish</code> | <code>DeadFishWrapper</code> | <code>unit.dead_fish</code> | | <code>.projectile</code> | <code>ProjectileWrapper</code> | <code>unit.projectile</code> | | <code>.building</code> | <code>BuildingWrapper</code> | <code>unit.building</code> | | <code>.resource_storages</code> | <code>ResourceStoragesWrapper</code> | <code>unit.resource_storages</code> | | <code>.damage_graphics</code> | <code>DamageGraphicsWrapper</code> | <code>unit.damage_graphics</code> | | <code>.tasks</code> | <code>TasksWrapper</code> | <code>unit.bird.tasks</code> |</p> <p>Collection methods (return Handle objects):</p> Method Returns Description <code>add_attack(class_, amount)</code> <code>AttackHandle</code> Add attack entry <code>get_attack_by_id(id)</code> <code>AttackHandle</code> Get by index <code>get_attack_by_class(class_)</code> <code>AttackHandle</code> Get by class <code>set_attack(class_, amount)</code> <code>AttackHandle</code> Update or add <code>remove_attack(id)</code> <code>bool</code> Remove by index <code>add_armour(...)</code> <code>ArmourHandle</code> Same pattern <code>add_task(...)</code> <code>TaskHandle</code> Add task with all params <code>add_damage_graphic(...)</code> <code>DamageGraphicHandle</code> Add damage state <code>add_train_location(...)</code> <code>TrainLocationHandle</code> Add training bldg <code>add_drop_site(unit_id)</code> <code>DropSiteHandle</code> Add drop site"},{"location":"code_notes/#22-genieunitmanager-unitsunit_managerpy","title":"2.2 GenieUnitManager (<code>Units/unit_manager.py</code>)","text":"<p>Unit CRUD operations. Extends <code>ToolBase</code>.</p> <p>Key methods:</p> <pre><code># Create new unit (clones from template)\ndef create(\n    name: str,\n    base_unit_id: Optional[int] = None,  # Clone source\n    unit_id: Optional[int] = None,       # Target ID\n    enable_for_civs: Optional[List[int]] = None,\n    on_conflict: Literal[\"error\", \"overwrite\"] = \"error\",\n    fill_gaps: Literal[\"error\", \"placeholder\"] = \"placeholder\",\n) -&gt; UnitHandle\n\n# Clone to specific ID\ndef clone_into(\n    dest_unit_id: int,\n    base_unit_id: int,\n    name: Optional[str] = None,\n    ...\n) -&gt; UnitHandle\n\n# Move unit (swaps IDs)\ndef move(\n    src_unit_id: int,\n    dst_unit_id: int,\n    on_conflict: Literal[\"error\", \"overwrite\", \"swap\"] = \"error\",\n    ...\n) -&gt; None\n\n# Get existing unit\ndef get(unit_id: int, civ_ids: Optional[List[int]] = None) -&gt; UnitHandle\n\n# Check existence (excludes placeholders)\ndef exists(unit_id: int) -&gt; bool\n</code></pre> <p>Placeholder detection: <pre><code>_is_placeholder(unit) = (unit.enabled == 0 and unit.name == \"\" and unit.hit_points == 1)\n</code></pre></p> <p>Invariants: - Unit tables have identical length across all civs - Gaps filled with placeholder units (not None)</p>"},{"location":"code_notes/#23-handle-classes-unitshandlespy","title":"2.3 Handle Classes (<code>Units/handles.py</code>)","text":"<p>Index-aware wrappers for collection items. Include their list index for removal.</p> Handle Wraps Key Properties <code>AttackHandle</code> <code>AttackOrArmor</code> <code>attack_id</code>, <code>class_</code>, <code>amount</code> <code>ArmourHandle</code> <code>AttackOrArmor</code> <code>armour_id</code>, <code>class_</code>, <code>amount</code> <code>TaskHandle</code> <code>Task</code> <code>task_id</code>, + all Task attrs <code>DamageGraphicHandle</code> <code>DamageGraphic</code> <code>damage_graphic_id</code>, <code>graphic_id</code>, <code>damage_percent</code> <code>TrainLocationHandle</code> <code>TrainLocation</code> <code>train_location_id</code>, <code>unit_id</code>, <code>button_id</code> <code>DropSiteHandle</code> <code>int</code> (list ref) <code>drop_site_id</code>, <code>unit_id</code>"},{"location":"code_notes/#24-wrappers-unitswrappers","title":"2.4 Wrappers (<code>Units/wrappers/</code>)","text":"<p>All wrappers follow the same pattern: 1. Receive <code>List[Unit]</code> in constructor 2. <code>_get_*()</code> reads from first unit 3. <code>_set_all(attr, value)</code> writes to all units</p> Wrapper Component Notable Properties <code>Type50Wrapper</code> <code>type_50</code> <code>max_range</code>, <code>reload_time</code>, <code>attack_graphic</code>, <code>attacks</code>, <code>armours</code> <code>CreatableWrapper</code> <code>creatable</code> <code>train_time</code>, <code>train_location_id</code>, <code>button_id</code>, <code>resource_costs</code> <code>CostWrapper</code> <code>creatable.resource_costs</code> <code>food</code>, <code>wood</code>, <code>gold</code>, <code>stone</code> (convenience) <code>BirdWrapper</code> <code>bird</code> <code>move_sound</code>, <code>attack_sound</code>, <code>work_rate</code>, <code>drop_sites</code>, <code>.tasks</code> <code>DeadFishWrapper</code> <code>dead_fish</code> <code>walking_graphic</code>, <code>rotation_speed</code>, <code>turn_radius</code> <code>ProjectileWrapper</code> <code>projectile</code> <code>projectile_type</code>, <code>smart_mode</code>, <code>hit_mode</code>, <code>projectile_arc</code> <code>BuildingWrapper</code> <code>building</code> <code>construction_graphic</code>, <code>garrison_type</code>, <code>annexes</code>, <code>looting_table</code> <code>TasksWrapper</code> <code>bird.tasks</code> <code>add_task()</code>, <code>remove_task()</code>, <code>list_tasks()</code>, <code>clear_tasks()</code> <code>ResourceStoragesWrapper</code> <code>resource_storages</code> <code>resource_1()</code>, <code>resource_2()</code>, <code>resource_3()</code>, <code>get()</code>, <code>set()</code> <code>DamageGraphicsWrapper</code> <code>damage_graphics</code> <code>add_damage_graphic()</code>, <code>remove_damage_graphic()</code>"},{"location":"code_notes/#3-graphics-module","title":"3. Graphics Module","text":""},{"location":"code_notes/#31-graphicmanager-graphicsgraphic_managerpy","title":"3.1 GraphicManager (<code>Graphics/graphic_manager.py</code>)","text":"<p>Graphic CRUD operations. Extends <code>ToolBase</code>.</p> <p>Key methods: <pre><code># Create new graphic\ndef add_graphic(\n    file_name: str,\n    name: Optional[str] = None,\n    graphic_id: Optional[int] = None,\n    frame_count: int = 1,\n    angle_count: int = 1,\n    frame_duration: float = 0.1,\n) -&gt; GraphicHandle\n\n# Copy graphic\ndef copy(source_id: int, target_id: Optional[int] = None) -&gt; GraphicHandle\n\n# Delete graphic (sets slot to None)\ndef delete(graphic_id: int) -&gt; bool\n\n# Search\ndef find_by_name(name: str) -&gt; Optional[GraphicHandle]\ndef find_by_file_name(file_name: str) -&gt; Optional[GraphicHandle]\n\n# Clipboard operations\ndef copy_to_clipboard(graphic_id: int) -&gt; bool\ndef paste(target_id: Optional[int] = None) -&gt; Optional[GraphicHandle]\n</code></pre></p> <p>Note: Graphics don't have civ-specific versions. Each exists once in <code>dat_file.graphics</code>.</p>"},{"location":"code_notes/#32-graphichandle-graphicsgraphic_handlepy","title":"3.2 GraphicHandle (<code>Graphics/graphic_handle.py</code>)","text":"<p>Direct access to Graphic properties.</p> <p>Constructor: <pre><code>GraphicHandle(graphic_id: int, dat_file: DatFile)\n</code></pre></p> <p>Key properties (read/write): - <code>name</code>, <code>file_name</code>, <code>slp</code> - <code>frame_count</code>, <code>angle_count</code>, <code>frame_duration</code>, <code>speed_multiplier</code> - <code>sound_id</code>, <code>wwise_sound_id</code> - <code>layer</code>, <code>player_color</code>, <code>coordinates</code> - <code>deltas</code> (list of <code>GraphicDelta</code>) - <code>angle_sounds</code> (list of <code>GraphicAngleSound</code>)</p> <p>Delta methods: <pre><code>add_delta(graphic_id, offset_x=0, offset_y=0, display_angle=-1) -&gt; DeltaHandle\nremove_delta(delta_id: int) -&gt; bool\nremove_delta_by_graphic(graphic_id: int) -&gt; bool\nget_delta(delta_id: int) -&gt; DeltaHandle\nclear_deltas() -&gt; None\n</code></pre></p> <p>DeltaHandle properties: <code>delta_id</code>, <code>graphic_id</code>, <code>offset_x</code>, <code>offset_y</code>, <code>display_angle</code></p>"},{"location":"code_notes/#4-key-patterns","title":"4. Key Patterns","text":""},{"location":"code_notes/#attribute-flattening","title":"Attribute Flattening","text":"<p><code>UnitHandle.__getattr__</code> searches through component names to find where an attribute lives: <pre><code>_COMPONENTS = (\"bird\", \"dead_fish\", \"type_50\", \"projectile\", \"creatable\", \"building\")\n</code></pre> Allows: <code>unit.move_sound = 5</code> instead of <code>unit.bird.move_sound = 5</code></p>"},{"location":"code_notes/#multi-civ-propagation","title":"Multi-Civ Propagation","text":"<p>All wrappers iterate over <code>self._units</code> (list of Unit from different civs) and apply changes to each.</p>"},{"location":"code_notes/#handle-pattern","title":"Handle Pattern","text":"<p>Collection items (attacks, tasks, etc.) return Handle objects containing both the data and the index, enabling: - Direct property access - Safe removal by index</p>"},{"location":"code_notes/#5-files-index-units-graphics","title":"5. Files Index (Units &amp; Graphics)","text":"File Lines Purpose <code>Units/unit_handle.py</code> 658 UnitHandle with attribute flattening <code>Units/unit_manager.py</code> 441 create/clone/move/get operations <code>Units/handles.py</code> 407 6 handle classes for collections <code>Units/wrappers/__init__.py</code> 30 Exports 10 wrapper classes <code>Units/wrappers/type_50.py</code> 348 Combat stats wrapper <code>Units/wrappers/creatable.py</code> 481 Training/creation wrapper <code>Units/wrappers/bird.py</code> 157 Movement/tasks wrapper <code>Units/wrappers/building.py</code> 273 Building stats wrapper <code>Units/wrappers/tasks.py</code> 242 Tasks collection wrapper <code>Graphics/graphic_manager.py</code> 331 add/copy/delete graphics <code>Graphics/graphic_handle.py</code> 573 GraphicHandle + DeltaHandle"},{"location":"code_notes/#6-open-questions","title":"6. Open Questions","text":"<ol> <li>How do wrappers handle units without the corresponding component (e.g., non-building unit accessing <code>.building</code>)?</li> <li>Observed: Returns <code>None</code> or empty defaults gracefully</li> <li>Is there a mechanism to copy all graphics/sounds from one unit to another?</li> <li>What happens when <code>invalidate_cache()</code> is not called after modifying <code>civ_ids</code>?</li> </ol> <p>End of Code Notes</p>"},{"location":"api/datasets/","title":"Datasets","text":"<p>Type-safe IntEnum constants for Genie Editor data.</p>"},{"location":"api/datasets/#available-datasets","title":"Available Datasets","text":"<pre><code>from Datasets import (\n    Resource,      # FOOD, WOOD, GOLD, STONE, etc.\n    UnitClass,     # INFANTRY, ARCHER, CAVALRY, etc.\n    Attribute,     # Object attributes for effects\n    Task,          # GATHER, BUILD, ATTACK, etc.\n    StoreMode,     # Resource storage flags\n    Effect,        # Effect types\n    TechModifier,  # Tech modification types\n)\n</code></pre>"},{"location":"api/datasets/#resource","title":"Resource","text":"<pre><code>from Datasets import Resource\n\nResource.FOOD    # 0\nResource.WOOD    # 1\nResource.STONE   # 2\nResource.GOLD    # 3\n</code></pre>"},{"location":"api/datasets/#unitclass","title":"UnitClass","text":"<pre><code>from Datasets import UnitClass\n\nUnitClass.ARCHER      # 0\nUnitClass.INFANTRY    # 6\nUnitClass.CAVALRY     # 12\n</code></pre>"},{"location":"api/datasets/#task","title":"Task","text":"<pre><code>from Datasets import Task\n\nTask.GATHER  # 1\nTask.BUILD   # 101\nTask.ATTACK  # 107\n</code></pre>"},{"location":"api/datasets/#usage-example","title":"Usage Example","text":"<pre><code>from Datasets import Resource, UnitClass\n\nunit.class_ = UnitClass.CAVALRY\nunit.resource_1(type=Resource.GOLD, amount=50.0, flag=2)\n</code></pre>"},{"location":"api/sounds/","title":"Sounds API","text":"<p>Coming soon</p> <p>The Sounds API provides control over sound entries in AoE2 DE DAT files.</p>"},{"location":"api/sounds/#quick-preview","title":"Quick Preview","text":"<pre><code>sm = workspace.sound_manager()\n\n# Create a new sound\nsound = sm.add_sound(filename=\"custom.wav\", probability=100)\n\n# Assign to unit\nunit.bird.attack_sound = sound.id\n</code></pre>"},{"location":"api/sounds/#soundmanager-methods","title":"SoundManager Methods","text":"Method Description <code>add_sound(filename, ...)</code> Create new sound <code>get(sound_id)</code> Get sound by ID <code>exists(sound_id)</code> Check if exists <code>count()</code> Total sound slots"},{"location":"api/techs/","title":"Techs API","text":"<p>Coming soon</p> <p>The Techs API provides control over technology entries in AoE2 DE DAT files.</p>"},{"location":"api/techs/#quick-preview","title":"Quick Preview","text":"<pre><code>tm = workspace.tech_manager()\n\n# Create a new tech\ntech = tm.add_tech(name=\"Custom Tech\")\n</code></pre>"},{"location":"api/graphics/deltas/","title":"Graphic Deltas","text":"<p>Deltas are sub-graphics attached to a parent graphic. They're used for: - Shadows \u2013 Rendered below the unit - Weapon effects \u2013 Sword swing trails, arrow flash - Attachments \u2013 Shields, flags, carried items - Damage states \u2013 Fire, smoke overlays</p>"},{"location":"api/graphics/deltas/#how-deltas-work","title":"How Deltas Work","text":"<p>A delta references another graphic ID and positions it relative to the parent:</p> <pre><code>Parent Graphic (hero_idle.slp)\n    \u2514\u2500\u2500 Delta 0: shadow.slp at offset (0, 5)\n    \u2514\u2500\u2500 Delta 1: shield.slp at offset (-3, -2)\n    \u2514\u2500\u2500 Delta 2: flag.slp at offset (2, -8)\n</code></pre> <p>Each delta has: - <code>graphic_id</code> \u2013 The referenced graphic - <code>offset_x</code>, <code>offset_y</code> \u2013 Position relative to parent - <code>display_angle</code> \u2013 Which angles to show (-1 = all)</p>"},{"location":"api/graphics/deltas/#deltahandle","title":"DeltaHandle","text":"<p>When you add or get a delta, you receive a <code>DeltaHandle</code>:</p>"},{"location":"api/graphics/deltas/#properties","title":"Properties","text":"Property Type Description <code>delta_id</code> <code>int</code> Index in parent's deltas list <code>graphic_id</code> <code>int</code> Referenced graphic ID <code>offset_x</code> <code>int</code> X offset from parent <code>offset_y</code> <code>int</code> Y offset from parent <code>display_angle</code> <code>int</code> Angle filter (-1 = all)"},{"location":"api/graphics/deltas/#adding-deltas","title":"Adding Deltas","text":""},{"location":"api/graphics/deltas/#basic-delta","title":"Basic Delta","text":"<pre><code>gfx = gm.get(100)\n\n# Add a shadow\ndelta = gfx.add_delta(graphic_id=200)\nprint(f\"Delta index: {delta.delta_id}\")\n</code></pre>"},{"location":"api/graphics/deltas/#with-offset","title":"With Offset","text":"<pre><code># Shadow slightly below and behind\ndelta = gfx.add_delta(\n    graphic_id=200,\n    offset_x=0,\n    offset_y=5,  # Below parent\n)\n</code></pre>"},{"location":"api/graphics/deltas/#with-angle-filter","title":"With Angle Filter","text":"<pre><code># Only show for front-facing angles\ndelta = gfx.add_delta(\n    graphic_id=300,\n    offset_x=-5,\n    offset_y=0,\n    display_angle=0,  # Only angle 0\n)\n\n# Show for all angles\ndelta = gfx.add_delta(\n    graphic_id=300,\n    display_angle=-1,  # All angles\n)\n</code></pre>"},{"location":"api/graphics/deltas/#modifying-deltas","title":"Modifying Deltas","text":""},{"location":"api/graphics/deltas/#via-deltahandle","title":"Via DeltaHandle","text":"<pre><code># Add delta\ndelta = gfx.add_delta(graphic_id=200)\n\n# Modify position\ndelta.offset_x = 2\ndelta.offset_y = 4\n\n# Change referenced graphic\ndelta.graphic_id = 201\n\n# Change angle\ndelta.display_angle = 2\n</code></pre>"},{"location":"api/graphics/deltas/#via-index","title":"Via Index","text":"<pre><code># Get existing delta\ndelta = gfx.get_delta(0)\nif delta:\n    delta.offset_y += 2\n</code></pre>"},{"location":"api/graphics/deltas/#removing-deltas","title":"Removing Deltas","text":""},{"location":"api/graphics/deltas/#by-index","title":"By Index","text":"<pre><code># Remove first delta\ngfx.remove_delta(delta_id=0)\n\n# Check result\nsuccess = gfx.remove_delta(delta_id=5)\nif not success:\n    print(\"Delta not found\")\n</code></pre>"},{"location":"api/graphics/deltas/#by-graphic-id","title":"By Graphic ID","text":"<p>Remove all deltas referencing a specific graphic:</p> <pre><code># Remove all shadow deltas\ngfx.remove_delta_by_graphic(graphic_id=200)\n</code></pre>"},{"location":"api/graphics/deltas/#clear-all","title":"Clear All","text":"<pre><code>gfx.clear_deltas()\n</code></pre>"},{"location":"api/graphics/deltas/#listing-deltas","title":"Listing Deltas","text":""},{"location":"api/graphics/deltas/#iterate-all","title":"Iterate All","text":"<pre><code>for i, delta in enumerate(gfx.deltas):\n    print(f\"Delta {i}:\")\n    print(f\"  Graphic: {delta.graphic_id}\")\n    print(f\"  Offset: ({delta.offset_x}, {delta.offset_y})\")\n    print(f\"  Angle: {delta.display_angle}\")\n</code></pre>"},{"location":"api/graphics/deltas/#count-deltas","title":"Count Deltas","text":"<pre><code>print(f\"Total deltas: {len(gfx.deltas)}\")\n</code></pre>"},{"location":"api/graphics/deltas/#common-patterns","title":"Common Patterns","text":""},{"location":"api/graphics/deltas/#adding-shadow","title":"Adding Shadow","text":"<pre><code>def add_shadow_to_graphic(gm, parent_id, shadow_id, y_offset=5):\n    \"\"\"Add a shadow delta to a graphic.\"\"\"\n    parent = gm.get(parent_id)\n    if parent.exists():\n        parent.add_delta(\n            graphic_id=shadow_id,\n            offset_x=0,\n            offset_y=y_offset,\n            display_angle=-1,\n        )\n        return True\n    return False\n\n# Usage\nadd_shadow_to_graphic(gm, parent_id=100, shadow_id=200)\n</code></pre>"},{"location":"api/graphics/deltas/#copying-deltas","title":"Copying Deltas","text":"<pre><code>def copy_deltas(source_gfx, target_gfx):\n    \"\"\"Copy all deltas from source to target.\"\"\"\n    for delta in source_gfx.deltas:\n        target_gfx.add_delta(\n            graphic_id=delta.graphic_id,\n            offset_x=delta.offset_x,\n            offset_y=delta.offset_y,\n            display_angle=delta.display_angle,\n        )\n\n# Usage\narcher_gfx = gm.get(100)  # Has deltas\nhero_gfx = gm.get(1000)   # Empty\ncopy_deltas(archer_gfx, hero_gfx)\n</code></pre>"},{"location":"api/graphics/deltas/#replacing-a-delta-graphic","title":"Replacing a Delta Graphic","text":"<pre><code>def replace_delta_graphic(gfx, old_id, new_id):\n    \"\"\"Replace all deltas pointing to old_id with new_id.\"\"\"\n    for delta in gfx.deltas:\n        if delta.graphic_id == old_id:\n            delta.graphic_id = new_id\n\n# Usage\nreplace_delta_graphic(gfx, old_id=200, new_id=201)\n</code></pre>"},{"location":"api/graphics/deltas/#adjusting-all-delta-offsets","title":"Adjusting All Delta Offsets","text":"<pre><code>def shift_all_deltas(gfx, dx, dy):\n    \"\"\"Shift all deltas by dx, dy.\"\"\"\n    for delta in gfx.deltas:\n        delta.offset_x += dx\n        delta.offset_y += dy\n\n# Usage\nshift_all_deltas(gfx, dx=0, dy=2)  # Move all down\n</code></pre>"},{"location":"api/graphics/deltas/#via-graphicmanager","title":"Via GraphicManager","text":"<p>You can also manage deltas through the manager:</p> <pre><code># Add delta\ngm.add_graphic_delta(\n    graphic_id=100,       # Parent\n    delta_graphic_id=200, # Delta\n    offset_x=0,\n    offset_y=5,\n)\n\n# Remove delta\ngm.remove_graphic_delta(\n    graphic_id=100,\n    delta_id=0,\n)\n</code></pre>"},{"location":"api/graphics/deltas/#complete-example-unit-with-full-delta-setup","title":"Complete Example: Unit with Full Delta Setup","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\ngm = workspace.graphic_manager()\num = workspace.genie_unit_manager()\n\n# Find reference graphics\nshadow = gm.find_by_name(\"SHADOW_CAVALRY\")\nflame = gm.find_by_name(\"FLAME_EFFECT\")\n\n# Create hero graphics\nidle = gm.add_graphic(\"hero_idle.slp\", frame_count=10, angle_count=8)\nwalk = gm.add_graphic(\"hero_walk.slp\", frame_count=15, angle_count=8)\nattack = gm.add_graphic(\"hero_attack.slp\", frame_count=12, angle_count=8)\n\n# Add shadow to all graphics\nfor gfx in [idle, walk, attack]:\n    if shadow:\n        gfx.add_delta(\n            graphic_id=shadow.id,\n            offset_x=0,\n            offset_y=4,\n        )\n        print(f\"Added shadow to graphic {gfx.id}\")\n\n# Add flame effect to attack (front angles only)\nif flame:\n    for angle in [0, 1, 7]:  # Front-ish angles\n        d = attack.add_delta(\n            graphic_id=flame.id,\n            offset_x=-8 if angle == 7 else (8 if angle == 1 else 0),\n            offset_y=-5,\n            display_angle=angle,\n        )\n        print(f\"Added flame for angle {angle}\")\n\n# Verify deltas\nprint(f\"\\nIdle deltas: {len(idle.deltas)}\")\nprint(f\"Walk deltas: {len(walk.deltas)}\")\nprint(f\"Attack deltas: {len(attack.deltas)}\")\n\n# Create unit with these graphics\nhero = um.create(\"Flame Knight\", base_unit_id=38)\nhero.standing_graphic = idle.id\nhero.dead_fish.walking_graphic = walk.id\nhero.combat.attack_graphic = attack.id\n\nworkspace.save(\"output.dat\")\nprint(f\"\\nCreated hero at ID {hero.id}\")\n</code></pre>"},{"location":"api/graphics/deltas/#delta-rendering-order","title":"Delta Rendering Order","text":"<p>Deltas are rendered in list order: 1. First delta = rendered first (behind) 2. Last delta = rendered last (on top)</p> <pre><code># Add shadow first (behind)\ngfx.add_delta(graphic_id=shadow_id, offset_y=5)\n\n# Add flame last (on top)\ngfx.add_delta(graphic_id=flame_id, offset_x=0, offset_y=-10)\n</code></pre> <p>To reorder, clear and re-add in desired order:</p> <pre><code># Store current deltas\ndeltas_data = [\n    (d.graphic_id, d.offset_x, d.offset_y, d.display_angle)\n    for d in gfx.deltas\n]\n\n# Clear\ngfx.clear_deltas()\n\n# Re-add in new order (reversed)\nfor gid, ox, oy, angle in reversed(deltas_data):\n    gfx.add_delta(graphic_id=gid, offset_x=ox, offset_y=oy, display_angle=angle)\n</code></pre>"},{"location":"api/graphics/graphic-handle/","title":"GraphicHandle","text":"<p>The <code>GraphicHandle</code> class provides direct access to graphic properties. Unlike <code>UnitHandle</code>, graphics don't have civ-specific versions.</p>"},{"location":"api/graphics/graphic-handle/#constructor","title":"Constructor","text":"<pre><code>GraphicHandle(graphic_id: int, dat_file: DatFile)\n</code></pre> <p>Note</p> <p>Use <code>GraphicManager.get()</code> or <code>.add_graphic()</code> instead of creating directly.</p>"},{"location":"api/graphics/graphic-handle/#basic-properties","title":"Basic Properties","text":"<pre><code>gm = workspace.graphic_manager()\ngfx = gm.get(100)\n\n# Check existence first\nif gfx.exists():\n    print(f\"ID: {gfx.id}\")\n    print(f\"Name: {gfx.name}\")\n    print(f\"File: {gfx.file_name}\")\n</code></pre>"},{"location":"api/graphics/graphic-handle/#core-properties","title":"Core Properties","text":"Property Type Description <code>id</code> <code>int</code> Graphic ID (read-only) <code>name</code> <code>str</code> Internal name <code>file_name</code> <code>str</code> SLP/SMX file name <code>slp</code> <code>int</code> SLP resource ID"},{"location":"api/graphics/graphic-handle/#animation-properties","title":"Animation Properties","text":"Property Type Description <code>frame_count</code> <code>int</code> Number of frames <code>angle_count</code> <code>int</code> Number of angles/facings <code>frame_duration</code> <code>float</code> Duration per frame (seconds) <code>speed_multiplier</code> <code>float</code> Animation speed multiplier <code>replay_delay</code> <code>float</code> Delay before replay <code>sequence_type</code> <code>int</code> Sequence type <code>mirroring_mode</code> <code>int</code> Mirroring mode"},{"location":"api/graphics/graphic-handle/#sound-properties","title":"Sound Properties","text":"Property Type Description <code>sound_id</code> <code>int</code> Associated sound ID <code>wwise_sound_id</code> <code>int</code> Wwise sound ID <code>angle_sounds_used</code> <code>int</code> Whether angle sounds active"},{"location":"api/graphics/graphic-handle/#visual-properties","title":"Visual Properties","text":"Property Type Description <code>layer</code> <code>int</code> Render layer <code>player_color</code> <code>int</code> Player color index <code>transparent_selection</code> <code>int</code> Transparent selection flag <code>coordinates</code> <code>tuple</code> Bounding box (x1, y1, x2, y2) <code>editor_flag</code> <code>int</code> Editor display flag"},{"location":"api/graphics/graphic-handle/#effects","title":"Effects","text":"Property Type Description <code>particle_effect_name</code> <code>str</code> Particle effect"},{"location":"api/graphics/graphic-handle/#example-modifying-properties","title":"Example: Modifying Properties","text":"<pre><code>gm = workspace.graphic_manager()\ngfx = gm.get(100)\n\n# Animation speed\ngfx.frame_count = 20\ngfx.frame_duration = 0.06  # Faster\ngfx.speed_multiplier = 1.5\n\n# Add sound\ngfx.sound_id = 50\n\n# Rendering\ngfx.layer = 10\ngfx.player_color = 1  # Red\n</code></pre>"},{"location":"api/graphics/graphic-handle/#deltas-sub-graphics","title":"Deltas (Sub-Graphics)","text":"<p>Deltas are child graphics attached to a parent (e.g., shadows, weapons).</p>"},{"location":"api/graphics/graphic-handle/#properties","title":"Properties","text":"Property Type Description <code>deltas</code> <code>List[GraphicDelta]</code> List of deltas"},{"location":"api/graphics/graphic-handle/#methods","title":"Methods","text":"Method Returns Description <code>add_delta(...)</code> <code>DeltaHandle</code> Add a delta <code>get_delta(delta_id)</code> <code>DeltaHandle</code> Get by index <code>remove_delta(delta_id)</code> <code>bool</code> Remove by index <code>remove_delta_by_graphic(gfx_id)</code> <code>bool</code> Remove by graphic ID <code>clear_deltas()</code> <code>None</code> Remove all deltas"},{"location":"api/graphics/graphic-handle/#example","title":"Example","text":"<pre><code># Get graphic\ngfx = gm.get(100)\n\n# Add shadow delta\nshadow = gfx.add_delta(\n    graphic_id=200,  # Shadow graphic\n    offset_x=0,\n    offset_y=5,\n    display_angle=-1,  # All angles\n)\nprint(f\"Added delta at index {shadow.delta_id}\")\n\n# Modify delta\nshadow.offset_y = 3\n\n# List all deltas\nfor delta in gfx.deltas:\n    print(f\"Delta: graphic={delta.graphic_id}, offset=({delta.offset_x}, {delta.offset_y})\")\n</code></pre> <p>See Deltas for complete delta documentation.</p>"},{"location":"api/graphics/graphic-handle/#angle-sounds","title":"Angle Sounds","text":"<p>Per-angle sound triggers for directional audio.</p>"},{"location":"api/graphics/graphic-handle/#methods_1","title":"Methods","text":"Method Description <code>add_angle_sound(...)</code> Add angle sound entry <code>clear_angle_sounds()</code> Remove all"},{"location":"api/graphics/graphic-handle/#example_1","title":"Example","text":"<pre><code># Add angle sound\ngfx.add_angle_sound(\n    frame_num=5,\n    sound_id=100,\n)\n\n# Clear all\ngfx.clear_angle_sounds()\n</code></pre>"},{"location":"api/graphics/graphic-handle/#complete-example","title":"Complete Example","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\ngm = workspace.graphic_manager()\n\n# Create attack animation\nattack = gm.add_graphic(\n    file_name=\"hero_attack.slp\",\n    frame_count=15,\n    angle_count=8,\n)\n\n# Configure animation\nattack.frame_duration = 0.07\nattack.speed_multiplier = 1.2\nattack.replay_delay = 0.0\n\n# Add sound\nattack.sound_id = 50\nattack.wwise_sound_id = 12345\n\n# Add shadow delta\nshadow = gm.find_by_name(\"SHADOW_CAVALRY\")\nif shadow:\n    delta = attack.add_delta(\n        graphic_id=shadow.id,\n        offset_x=0,\n        offset_y=3,\n    )\n    print(f\"Added shadow at delta index {delta.delta_id}\")\n\n# Add weapon flash delta\nflash = gm.find_by_name(\"WEAPON_FLASH\")\nif flash:\n    attack.add_delta(\n        graphic_id=flash.id,\n        offset_x=-5,\n        offset_y=-10,\n        display_angle=0,  # Only front-facing\n    )\n\n# Print summary\nprint(f\"Graphic {attack.id}:\")\nprint(f\"  File: {attack.file_name}\")\nprint(f\"  Frames: {attack.frame_count} @ {attack.frame_duration}s\")\nprint(f\"  Deltas: {len(attack.deltas)}\")\n\nworkspace.save(\"output.dat\")\n</code></pre>"},{"location":"api/graphics/graphic-manager/","title":"GraphicManager","text":"<p>The <code>GraphicManager</code> class handles graphic CRUD operations: create, copy, delete, and search.</p>"},{"location":"api/graphics/graphic-manager/#getting-the-manager","title":"Getting the Manager","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\ngm = workspace.graphic_manager()\n</code></pre>"},{"location":"api/graphics/graphic-manager/#methods","title":"Methods","text":""},{"location":"api/graphics/graphic-manager/#add_graphic","title":"add_graphic()","text":"<p>Create a new graphic entry.</p> <pre><code>def add_graphic(\n    file_name: str,\n    name: Optional[str] = None,\n    graphic_id: Optional[int] = None,\n    frame_count: int = 1,\n    angle_count: int = 1,\n    frame_duration: float = 0.1,\n    speed_multiplier: float = 1.0,\n) -&gt; GraphicHandle\n</code></pre> Parameter Type Description <code>file_name</code> <code>str</code> SLP/SMX file name <code>name</code> <code>str</code> Internal name. <code>None</code> = use file_name <code>graphic_id</code> <code>int</code> Target ID. <code>None</code> = auto-assign <code>frame_count</code> <code>int</code> Number of animation frames <code>angle_count</code> <code>int</code> Number of angles/facings <code>frame_duration</code> <code>float</code> Duration per frame (seconds) <code>speed_multiplier</code> <code>float</code> Animation speed"},{"location":"api/graphics/graphic-manager/#examples","title":"Examples","text":"<pre><code># Basic creation\ngfx = gm.add_graphic(\"my_unit.slp\")\nprint(f\"ID: {gfx.id}\")\n\n# With animation settings\nattack_gfx = gm.add_graphic(\n    file_name=\"hero_attack.slp\",\n    frame_count=15,\n    angle_count=8,\n    frame_duration=0.08,\n)\n\n# At specific ID\ngm.add_graphic(\"custom.slp\", graphic_id=20000)\n</code></pre>"},{"location":"api/graphics/graphic-manager/#get","title":"get()","text":"<p>Get a handle for an existing graphic.</p> <pre><code>def get(graphic_id: int) -&gt; GraphicHandle\n</code></pre> <p>Note</p> <p>Returns a handle even if the graphic doesn't exist. Check <code>.exists()</code> to verify.</p>"},{"location":"api/graphics/graphic-manager/#example","title":"Example","text":"<pre><code>gfx = gm.get(100)\nif gfx.exists():\n    print(f\"Name: {gfx.name}\")\n    print(f\"Frames: {gfx.frame_count}\")\n</code></pre>"},{"location":"api/graphics/graphic-manager/#copy","title":"copy()","text":"<p>Copy a graphic to a new ID.</p> <pre><code>def copy(source_id: int, target_id: Optional[int] = None) -&gt; GraphicHandle\n</code></pre> Parameter Type Description <code>source_id</code> <code>int</code> ID of graphic to copy <code>target_id</code> <code>int</code> Destination ID. <code>None</code> = auto-assign"},{"location":"api/graphics/graphic-manager/#example_1","title":"Example","text":"<pre><code># Copy to auto-assigned ID\ncopied = gm.copy(source_id=100)\nprint(f\"Copied to ID {copied.id}\")\n\n# Copy to specific ID\ngm.copy(source_id=100, target_id=5000)\n</code></pre>"},{"location":"api/graphics/graphic-manager/#delete","title":"delete()","text":"<p>Delete a graphic (sets slot to <code>None</code>).</p> <pre><code>def delete(graphic_id: int) -&gt; bool\n</code></pre>"},{"location":"api/graphics/graphic-manager/#example_2","title":"Example","text":"<pre><code>if gm.delete(5000):\n    print(\"Deleted successfully\")\nelse:\n    print(\"Graphic didn't exist\")\n</code></pre>"},{"location":"api/graphics/graphic-manager/#exists","title":"exists()","text":"<p>Check if a graphic ID exists and is not <code>None</code>.</p> <pre><code>def exists(graphic_id: int) -&gt; bool\n</code></pre>"},{"location":"api/graphics/graphic-manager/#example_3","title":"Example","text":"<pre><code>if gm.exists(100):\n    gfx = gm.get(100)\n</code></pre>"},{"location":"api/graphics/graphic-manager/#find_by_name","title":"find_by_name()","text":"<p>Find first graphic matching name.</p> <pre><code>def find_by_name(name: str) -&gt; Optional[GraphicHandle]\n</code></pre>"},{"location":"api/graphics/graphic-manager/#example_4","title":"Example","text":"<pre><code>gfx = gm.find_by_name(\"ARCHER_ATTACK\")\nif gfx:\n    print(f\"Found at ID {gfx.id}\")\n</code></pre>"},{"location":"api/graphics/graphic-manager/#find_by_file_name","title":"find_by_file_name()","text":"<p>Find first graphic matching file name.</p> <pre><code>def find_by_file_name(file_name: str) -&gt; Optional[GraphicHandle]\n</code></pre>"},{"location":"api/graphics/graphic-manager/#example_5","title":"Example","text":"<pre><code>gfx = gm.find_by_file_name(\"archer_attack.slp\")\nif gfx:\n    print(f\"Found at ID {gfx.id}\")\n</code></pre>"},{"location":"api/graphics/graphic-manager/#count-count_active","title":"count() / count_active()","text":"<p>Get total slots and active (non-None) count.</p> <pre><code>def count() -&gt; int      # Total slots\ndef count_active() -&gt; int  # Non-None slots\n</code></pre>"},{"location":"api/graphics/graphic-manager/#example_6","title":"Example","text":"<pre><code>print(f\"Total: {gm.count()}, Active: {gm.count_active()}\")\n</code></pre>"},{"location":"api/graphics/graphic-manager/#clipboard-operations","title":"Clipboard Operations","text":""},{"location":"api/graphics/graphic-manager/#copy_to_clipboard","title":"copy_to_clipboard()","text":"<p>Copy a graphic to internal clipboard.</p> <pre><code>def copy_to_clipboard(graphic_id: int) -&gt; bool\n</code></pre>"},{"location":"api/graphics/graphic-manager/#paste","title":"paste()","text":"<p>Paste from clipboard to new ID.</p> <pre><code>def paste(target_id: Optional[int] = None) -&gt; Optional[GraphicHandle]\n</code></pre>"},{"location":"api/graphics/graphic-manager/#clear_clipboard","title":"clear_clipboard()","text":"<p>Clear the internal clipboard.</p> <pre><code>def clear_clipboard() -&gt; None\n</code></pre>"},{"location":"api/graphics/graphic-manager/#example_7","title":"Example","text":"<pre><code># Copy archer attack to clipboard\ngm.copy_to_clipboard(100)\n\n# Paste multiple times\nfor i in range(5):\n    pasted = gm.paste()\n    print(f\"Pasted to ID {pasted.id}\")\n\n# Clean up\ngm.clear_clipboard()\n</code></pre>"},{"location":"api/graphics/graphic-manager/#delta-management-via-manager","title":"Delta Management via Manager","text":"<p>You can also add/remove deltas through the manager:</p> <pre><code># Add delta to graphic 100\ngm.add_graphic_delta(\n    graphic_id=100,\n    delta_graphic_id=200,  # Shadow\n    offset_x=0,\n    offset_y=5,\n)\n\n# Remove delta by index\ngm.remove_graphic_delta(graphic_id=100, delta_id=0)\n</code></pre>"},{"location":"api/graphics/graphic-manager/#complete-example","title":"Complete Example","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\ngm = workspace.graphic_manager()\n\nprint(f\"Graphics: {gm.count_active()} / {gm.count()}\")\n\n# Create new graphics\nidle_gfx = gm.add_graphic(\n    file_name=\"hero_idle.slp\",\n    frame_count=10,\n    angle_count=8,\n    frame_duration=0.1,\n)\n\nattack_gfx = gm.add_graphic(\n    file_name=\"hero_attack.slp\",\n    frame_count=15,\n    angle_count=8,\n    frame_duration=0.08,\n)\n\ndeath_gfx = gm.add_graphic(\n    file_name=\"hero_death.slp\",\n    frame_count=20,\n    angle_count=8,\n)\n\nprint(f\"Created: idle={idle_gfx.id}, attack={attack_gfx.id}, death={death_gfx.id}\")\n\n# Add shadow to idle\nshadow_gfx = gm.find_by_name(\"SHADOW_UNIT\")\nif shadow_gfx:\n    idle_gfx.add_delta(\n        graphic_id=shadow_gfx.id,\n        offset_x=0,\n        offset_y=2,\n    )\n    print(\"Added shadow delta\")\n\n# Copy existing graphic for modification\ncrossbow_attack = gm.find_by_file_name(\"x_crossbow_attack.slp\")\nif crossbow_attack:\n    copied = gm.copy(source_id=crossbow_attack.id)\n    copied.name = \"HERO_CROSSBOW_ATTACK\"\n    copied.speed_multiplier = 1.5  # Faster animation\n    print(f\"Copied to ID {copied.id}\")\n\nworkspace.save(\"output.dat\")\n</code></pre>"},{"location":"api/graphics/overview/","title":"Graphics API Overview","text":"<p>The Graphics API provides control over graphic entries in AoE2 DE DAT files.</p>"},{"location":"api/graphics/overview/#architecture","title":"Architecture","text":"<pre><code>GenieWorkspace\n    \u2514\u2500\u2500 graphic_manager() \u2192 GraphicManager\n                               \u2514\u2500\u2500 add_graphic() / get() \u2192 GraphicHandle\n                                                              \u2514\u2500\u2500 .deltas \u2192 DeltaHandle[]\n</code></pre>"},{"location":"api/graphics/overview/#key-differences-from-units","title":"Key Differences from Units","text":"<ul> <li>No civ-specific versions \u2013 Each graphic exists once in <code>dat_file.graphics</code></li> <li>Simpler structure \u2013 No nested wrappers, direct property access</li> <li>Deltas \u2013 Graphics can have sub-graphics (shadows, attachments)</li> </ul>"},{"location":"api/graphics/overview/#quick-reference","title":"Quick Reference","text":"Class Purpose GraphicManager Create, copy, delete graphics GraphicHandle Access and modify graphic properties Deltas Sub-graphics (shadows, attachments)"},{"location":"api/graphics/overview/#basic-usage","title":"Basic Usage","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\ngm = workspace.graphic_manager()\n\n# Create a new graphic\nattack_gfx = gm.add_graphic(\n    file_name=\"hero_attack.slp\",\n    frame_count=15,\n    angle_count=8,\n)\nprint(f\"Created graphic ID: {attack_gfx.id}\")\n\n# Copy existing graphic\ncopied = gm.copy(source_id=100, target_id=5000)\n\n# Modify properties\ncopied.frame_duration = 0.08\ncopied.sound_id = 50\n\n# Add shadow delta\ncopied.add_delta(graphic_id=200, offset_y=5)\n\nworkspace.save(\"output.dat\")\n</code></pre>"},{"location":"api/units/handles/","title":"Handles","text":"<p>Handles are index-aware wrappers for collection items. They contain both the data and the item's position in the parent list.</p>"},{"location":"api/units/handles/#why-handles","title":"Why Handles?","text":"<p>When you add an attack to a unit, you need to know: 1. The attack data (class, amount) 2. The index for later removal</p> <p>Handles provide both:</p> <pre><code>attack = unit.add_attack(class_=3, amount=6)\nprint(attack.attack_id)  # Index in attacks list\nprint(attack.class_)     # 3\nprint(attack.amount)     # 6\n\n# Later, remove by index\nunit.remove_attack(attack.attack_id)\n</code></pre>"},{"location":"api/units/handles/#attackhandle","title":"AttackHandle","text":"<p>Wraps an attack entry with its index.</p>"},{"location":"api/units/handles/#properties","title":"Properties","text":"Property Type Description <code>attack_id</code> <code>int</code> Index in attacks list <code>class_</code> <code>int</code> Attack class (damage type) <code>amount</code> <code>int</code> Damage amount"},{"location":"api/units/handles/#example","title":"Example","text":"<pre><code># Add attack\nattack = unit.add_attack(class_=4, amount=10)\nprint(f\"Attack {attack.attack_id}: class={attack.class_}, amount={attack.amount}\")\n\n# Modify\nattack.amount = 15\n\n# Get by class\nmelee = unit.get_attack_by_class(class_=4)\nif melee:\n    melee.amount += 5\n</code></pre>"},{"location":"api/units/handles/#armourhandle","title":"ArmourHandle","text":"<p>Wraps an armor entry with its index.</p>"},{"location":"api/units/handles/#properties_1","title":"Properties","text":"Property Type Description <code>armour_id</code> <code>int</code> Index in armours list <code>class_</code> <code>int</code> Armor class (defense type) <code>amount</code> <code>int</code> Defense amount"},{"location":"api/units/handles/#example_1","title":"Example","text":"<pre><code># Add armor\narmor = unit.add_armour(class_=3, amount=2)\nprint(f\"Armor {armor.armour_id}: class={armor.class_}, amount={armor.amount}\")\n\n# Modify\narmor.amount = 5\n</code></pre>"},{"location":"api/units/handles/#taskhandle","title":"TaskHandle","text":"<p>Wraps a task with its index.</p>"},{"location":"api/units/handles/#properties_2","title":"Properties","text":"Property Type Description <code>task_id</code> <code>int</code> Index in tasks list <code>task_type</code> <code>int</code> Task type <code>id</code> <code>int</code> Task's internal ID <code>is_default</code> <code>int</code> Default task flag <code>resource_in</code> <code>int</code> Input resource <code>resource_out</code> <code>int</code> Output resource <code>work_value_1</code> <code>float</code> Work amount <code>work_range</code> <code>float</code> Work range <code>enabled</code> <code>int</code> Enabled flag ... ... All Task properties"},{"location":"api/units/handles/#example_2","title":"Example","text":"<pre><code># Add task\ntask = unit.add_task(task_type=7, id=10, work_value_1=0.5)\nprint(f\"Task at index {task.task_id}, type={task.task_type}\")\n\n# Modify\ntask.work_value_1 = 1.0\ntask.enabled = 1\n\n# Get by index\ntask = unit.get_task(0)\n</code></pre>"},{"location":"api/units/handles/#damagegraphichandle","title":"DamageGraphicHandle","text":"<p>Wraps a damage graphic state.</p>"},{"location":"api/units/handles/#properties_3","title":"Properties","text":"Property Type Description <code>damage_graphic_id</code> <code>int</code> Index in damage_graphics <code>graphic_id</code> <code>int</code> Graphic to display <code>damage_percent</code> <code>int</code> HP threshold (0-100) <code>apply_mode</code> <code>int</code> Apply mode"},{"location":"api/units/handles/#example_3","title":"Example","text":"<pre><code># Add damage state at 50% HP\ndmg = unit.add_damage_graphic(graphic_id=450, damage_percent=50)\nprint(f\"Damage graphic {dmg.damage_graphic_id} at {dmg.damage_percent}%\")\n\n# Modify\ndmg.graphic_id = 451\n\n# Remove\nunit.remove_damage_graphic(dmg.damage_graphic_id)\n</code></pre>"},{"location":"api/units/handles/#trainlocationhandle","title":"TrainLocationHandle","text":"<p>Wraps a training location.</p>"},{"location":"api/units/handles/#properties_4","title":"Properties","text":"Property Type Description <code>train_location_id</code> <code>int</code> Index in train_locations <code>unit_id</code> <code>int</code> Building unit ID <code>train_time</code> <code>int</code> Training time <code>button_id</code> <code>int</code> Button position <code>hot_key_id</code> <code>int</code> Hotkey ID"},{"location":"api/units/handles/#example_4","title":"Example","text":"<pre><code># Add training at Barracks\nloc = unit.add_train_location(unit_id=12, train_time=30, button_id=1)\nprint(f\"Trains at building {loc.unit_id}\")\n\n# Modify\nloc.train_time = 25\n</code></pre>"},{"location":"api/units/handles/#dropsitehandle","title":"DropSiteHandle","text":"<p>Wraps a drop site reference.</p>"},{"location":"api/units/handles/#properties_5","title":"Properties","text":"Property Type Description <code>drop_site_id</code> <code>int</code> Index in drop_sites <code>unit_id</code> <code>int</code> Building unit ID"},{"location":"api/units/handles/#example_5","title":"Example","text":"<pre><code># Add Town Center as drop site\nsite = unit.add_drop_site(unit_id=109)\nprint(f\"Drop site {site.drop_site_id}: building {site.unit_id}\")\n\n# Change to Mill\nsite.unit_id = 68\n</code></pre>"},{"location":"api/units/handles/#complete-example","title":"Complete Example","text":"<pre><code>um = workspace.genie_unit_manager()\nunit = um.get(4)  # Archer\n\n# Track all handles\nattack_handles = []\narmor_handles = []\n\n# Add attacks\nfor class_, amount in [(3, 6), (8, 2), (11, 1)]:\n    handle = unit.add_attack(class_=class_, amount=amount)\n    attack_handles.append(handle)\n    print(f\"Added attack {handle.attack_id}: class={class_}, amount={amount}\")\n\n# Modify via handle\nattack_handles[0].amount = 10  # Increase pierce damage\n\n# Add armor\narmor = unit.add_armour(class_=3, amount=0)\narmor.amount = 2  # Modify via handle\n\n# Print all\nprint(\"\\nFinal attacks:\")\nfor atk in unit.attacks:\n    print(f\"  Class {atk.class_}: {atk.amount}\")\n\nprint(\"\\nFinal armor:\")\nfor arm in unit.armours:\n    print(f\"  Class {arm.class_}: {arm.amount}\")\n</code></pre>"},{"location":"api/units/overview/","title":"Units API Overview","text":"<p>The Units API provides complete control over unit data in AoE2 DE DAT files.</p>"},{"location":"api/units/overview/#architecture","title":"Architecture","text":"<pre><code>GenieWorkspace\n    \u2514\u2500\u2500 genie_unit_manager() \u2192 GenieUnitManager\n                                    \u2514\u2500\u2500 create() / get() \u2192 UnitHandle\n                                                              \u251c\u2500\u2500 .combat \u2192 Type50Wrapper\n                                                              \u251c\u2500\u2500 .bird \u2192 BirdWrapper\n                                                              \u251c\u2500\u2500 .creatable \u2192 CreatableWrapper\n                                                              \u251c\u2500\u2500 .cost \u2192 CostWrapper\n                                                              \u251c\u2500\u2500 .building \u2192 BuildingWrapper\n                                                              \u251c\u2500\u2500 .tasks \u2192 TasksWrapper\n                                                              \u2514\u2500\u2500 .resource_storages \u2192 ResourceStoragesWrapper\n</code></pre>"},{"location":"api/units/overview/#key-concepts","title":"Key Concepts","text":""},{"location":"api/units/overview/#multi-civ-propagation","title":"Multi-Civ Propagation","text":"<p>When you modify a <code>UnitHandle</code>, changes apply to all civilizations automatically:</p> <pre><code>um = workspace.genie_unit_manager()\nunit = um.get(4)  # Archer\n\n# This changes the Archer's HP for ALL civs\nunit.hit_points = 50\n</code></pre>"},{"location":"api/units/overview/#attribute-flattening","title":"Attribute Flattening","text":"<p>Access deeply nested properties directly on the handle:</p> <pre><code># Instead of: unit.bird.move_sound = 5\nunit.move_sound = 5\n\n# Instead of: unit.type_50.max_range = 7.0\nunit.max_range = 7.0\n</code></pre>"},{"location":"api/units/overview/#handle-pattern","title":"Handle Pattern","text":"<p>Collection items (attacks, tasks, etc.) return Handle objects with their index:</p> <pre><code>attack = unit.add_attack(class_=3, amount=6)\nprint(attack.attack_id)  # Index in attacks list\nprint(attack.class_)     # 3\nprint(attack.amount)     # 6\n</code></pre>"},{"location":"api/units/overview/#quick-reference","title":"Quick Reference","text":"Class Purpose GenieUnitManager Create, clone, move, delete units UnitHandle Access and modify unit properties Wrappers Type50, Bird, Creatable, Building, etc. Handles Attack, Armour, Task, DamageGraphic handles"},{"location":"api/units/overview/#basic-usage","title":"Basic Usage","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\num = workspace.genie_unit_manager()\n\n# Create a new unit\nhero = um.create(\"Hero Knight\", base_unit_id=38)\nhero.hit_points = 200\nhero.speed = 1.5\n\n# Modify existing unit\narcher = um.get(4)\narcher.max_range = 7.0\n\n# Add attacks and armor\nhero.add_attack(class_=4, amount=15)  # Melee\nhero.add_armour(class_=3, amount=5)   # Pierce armor\n\nworkspace.save(\"output.dat\")\n</code></pre>"},{"location":"api/units/unit-handle/","title":"UnitHandle","text":"<p>The <code>UnitHandle</code> class is the primary interface for reading and modifying unit data. It wraps one or more <code>genieutils.unit.Unit</code> objects and propagates changes across all civilizations.</p>"},{"location":"api/units/unit-handle/#constructor","title":"Constructor","text":"<pre><code>UnitHandle(unit_id: int, dat_file: DatFile, civ_ids: Optional[List[int]] = None)\n</code></pre> Parameter Type Description <code>unit_id</code> <code>int</code> The unit ID to wrap <code>dat_file</code> <code>DatFile</code> The source DAT file <code>civ_ids</code> <code>List[int]</code> Civilizations to affect. <code>None</code> = all <p>Creating UnitHandles</p> <p>You typically don't create <code>UnitHandle</code> directly. Use <code>GenieUnitManager.get()</code> or <code>.create()</code> instead.</p>"},{"location":"api/units/unit-handle/#basic-properties","title":"Basic Properties","text":"<pre><code>um = workspace.genie_unit_manager()\nunit = um.get(4)  # Archer\n\n# Read-only\nprint(unit.id)    # 4\nprint(unit.name)  # \"Archer\"\n\n# Writable\nunit.name = \"Elite Archer\"\nunit.hit_points = 50\nunit.speed = 1.2\n</code></pre>"},{"location":"api/units/unit-handle/#common-flattened-properties","title":"Common Flattened Properties","text":"<p>These properties are accessible directly on <code>UnitHandle</code>:</p> Property Type Source Description <code>name</code> <code>str</code> Unit Unit name <code>hit_points</code> <code>int</code> Unit Max HP <code>speed</code> <code>float</code> Unit Movement speed <code>line_of_sight</code> <code>float</code> Unit Vision range <code>garrison_capacity</code> <code>int</code> Unit Max garrison <code>icon_id</code> <code>int</code> Unit Icon graphic ID <code>standing_graphic</code> <code>int</code> Unit Idle graphic ID <code>dying_graphic</code> <code>int</code> Unit Death graphic ID <code>move_sound</code> <code>int</code> Bird Movement sound ID <code>attack_sound</code> <code>int</code> Bird Attack sound ID <code>max_range</code> <code>float</code> Type50 Attack range <code>reload_time</code> <code>float</code> Type50 Attack cooldown <code>attack_graphic</code> <code>int</code> Type50 Attack animation ID <code>train_time</code> <code>int</code> Creatable Training time <code>train_location_id</code> <code>int</code> Creatable Where trained"},{"location":"api/units/unit-handle/#wrapper-properties","title":"Wrapper Properties","text":"<p>Access specialized wrappers for grouped properties:</p> <pre><code>unit = um.get(4)\n\n# Combat stats (Type50)\nunit.combat.max_range = 7.0\nunit.combat.reload_time = 2.0\nunit.combat.accuracy_percent = 80\n\n# Training info (Creatable)\nunit.creatable.train_time = 35\nunit.creatable.train_location_id = 12  # Archery Range\n\n# Cost (convenience wrapper)\nunit.cost.food = 0\nunit.cost.wood = 25\nunit.cost.gold = 45\n\n# Movement (Bird)\nunit.bird.move_sound = 5\nunit.bird.attack_sound = 6\nunit.bird.work_rate = 0.8\n\n# Building (for buildings)\nunit.building.garrison_type = 2\nunit.building.construction_graphic = 100\n</code></pre>"},{"location":"api/units/unit-handle/#available-wrappers","title":"Available Wrappers","text":"Property Wrapper Class Purpose <code>.combat</code> <code>Type50Wrapper</code> Attack stats, range, armor <code>.creatable</code> <code>CreatableWrapper</code> Training, costs, button <code>.cost</code> <code>CostWrapper</code> Food/wood/gold/stone costs <code>.bird</code> <code>BirdWrapper</code> Movement, sounds, tasks <code>.dead_fish</code> <code>DeadFishWrapper</code> Walking graphics, rotation <code>.projectile</code> <code>ProjectileWrapper</code> Projectile behavior <code>.building</code> <code>BuildingWrapper</code> Construction, garrison <code>.resource_storages</code> <code>ResourceStoragesWrapper</code> Resource carrying <code>.damage_graphics</code> <code>DamageGraphicsWrapper</code> Damage visuals <code>.tasks</code> <code>TasksWrapper</code> Unit commands/abilities"},{"location":"api/units/unit-handle/#attacks-and-armor","title":"Attacks and Armor","text":""},{"location":"api/units/unit-handle/#adding-attacks","title":"Adding Attacks","text":"<pre><code>unit = um.get(4)\n\n# Add a new attack\nattack = unit.add_attack(class_=3, amount=6)  # Pierce damage\nprint(f\"Added attack at index {attack.attack_id}\")\n\n# Add bonus damage vs cavalry\nunit.add_attack(class_=8, amount=4)  # Bonus vs Cavalry\n</code></pre>"},{"location":"api/units/unit-handle/#modifying-attacks","title":"Modifying Attacks","text":"<pre><code># Get attack by class\nattack = unit.get_attack_by_class(class_=3)\nif attack:\n    attack.amount = 10  # Increase pierce damage\n\n# Or use set_attack (updates existing or adds new)\nunit.set_attack(class_=3, amount=10)\n</code></pre>"},{"location":"api/units/unit-handle/#reading-all-attacks","title":"Reading All Attacks","text":"<pre><code>for attack in unit.attacks:\n    print(f\"Class {attack.class_}: {attack.amount} damage\")\n</code></pre>"},{"location":"api/units/unit-handle/#replacing-all-attacks","title":"Replacing All Attacks","text":"<pre><code>from genieutils.unit import AttackOrArmor\n\nunit.attacks = [\n    AttackOrArmor(class_=3, amount=8),   # Pierce\n    AttackOrArmor(class_=4, amount=5),   # Melee\n    AttackOrArmor(class_=11, amount=3),  # Bonus vs Buildings\n]\n</code></pre>"},{"location":"api/units/unit-handle/#armor-same-pattern","title":"Armor (Same Pattern)","text":"<pre><code># Add armor\narmor = unit.add_armour(class_=3, amount=2)  # Pierce armor\n\n# Get/set armor\nunit.set_armour(class_=4, amount=3)  # Melee armor\n\n# Read all armor\nfor arm in unit.armours:\n    print(f\"Class {arm.class_}: {arm.amount} defense\")\n</code></pre>"},{"location":"api/units/unit-handle/#tasks","title":"Tasks","text":"<p>Tasks define what actions a unit can perform (gather, build, attack, etc.).</p>"},{"location":"api/units/unit-handle/#adding-tasks","title":"Adding Tasks","text":"<pre><code>from Datasets import Task, Resource\n\nunit = um.get(83)  # Villager\n\n# Add a gather task\ntask = unit.add_task(\n    task_type=Task.GATHER,\n    resource_in=Resource.FOOD,\n    resource_out=Resource.FOOD,\n    work_range=0.5,\n    work_value_1=0.4,  # Gather rate\n)\nprint(f\"Added task at index {task.task_id}\")\n</code></pre>"},{"location":"api/units/unit-handle/#using-taskswrapper","title":"Using TasksWrapper","text":"<pre><code># List all tasks\nfor task in unit.tasks.list_tasks():\n    print(f\"Task {task.id}: type={task.task_type}\")\n\n# Remove a task\nunit.tasks.remove_task(task_id=3)\n\n# Clear all tasks\nunit.tasks.clear_tasks()\n\n# Add via wrapper\nunit.tasks.add_task(\n    task_type=7,\n    id=10,\n    work_value_1=1.0,\n)\n</code></pre>"},{"location":"api/units/unit-handle/#resource-storages","title":"Resource Storages","text":"<p>Control what resources a unit can carry (e.g., sheep carry food).</p> <pre><code>from Datasets import Resource, StoreMode\n\nunit = um.get(594)  # Sheep\n\n# Set storage slot 1: 100 food\nunit.resource_1(type=Resource.FOOD, amount=100.0, flag=StoreMode.GIVE_ONLY)\n\n# Or use the wrapper\nunit.resource_storages.resource_1(type=Resource.FOOD, amount=100.0, flag=1)\nunit.resource_storages.resource_2(type=Resource.WOOD, amount=50.0, flag=0)\n\n# Read storage\nstorage = unit.resource_storages\nslot0 = storage.get(0)\nprint(f\"Slot 0: type={slot0.type}, amount={slot0.amount}\")\n</code></pre>"},{"location":"api/units/unit-handle/#damage-graphics","title":"Damage Graphics","text":"<p>Define how the unit looks when damaged.</p> <pre><code># Add damage state at 50% HP\ndmg = unit.add_damage_graphic(graphic_id=450, damage_percent=50)\nprint(f\"Added at index {dmg.damage_graphic_id}\")\n\n# Add another at 25% HP\nunit.add_damage_graphic(graphic_id=451, damage_percent=25)\n\n# Remove\nunit.remove_damage_graphic(damage_graphic_id=0)\n</code></pre>"},{"location":"api/units/unit-handle/#train-locations","title":"Train Locations","text":"<p>Define where a unit can be trained.</p> <pre><code># Add training at Barracks (ID 12)\nloc = unit.add_train_location(\n    unit_id=12,\n    train_time=30,\n    button_id=1,\n    hot_key_id=16389,\n)\n\n# Remove\nunit.remove_train_location(train_location_id=0)\n</code></pre>"},{"location":"api/units/unit-handle/#drop-sites","title":"Drop Sites","text":"<p>Define where a unit can deposit gathered resources.</p> <pre><code># Add Town Center as drop site\nunit.add_drop_site(unit_id=109)\n\n# Add Mill\nunit.add_drop_site(unit_id=68)\n\n# Remove\nunit.remove_drop_site(drop_site_id=0)\n</code></pre>"},{"location":"api/units/unit-handle/#complete-example","title":"Complete Example","text":"<pre><code>from Actual_Tools import GenieWorkspace\nfrom Datasets import Resource, UnitClass\nfrom genieutils.unit import AttackOrArmor\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\num = workspace.genie_unit_manager()\ngm = workspace.graphic_manager()\nsm = workspace.sound_manager()\n\n# Create hero unit\nhero = um.create(\"Champion Knight\", base_unit_id=38)\n\n# Basic stats\nhero.hit_points = 250\nhero.speed = 1.6\nhero.line_of_sight = 6\nhero.class_ = UnitClass.CAVALRY\n\n# Combat stats\nhero.combat.max_range = 0\nhero.combat.reload_time = 1.8\nhero.combat.displayed_attack = 18\n\n# Attacks\nhero.attacks = [\n    AttackOrArmor(class_=4, amount=18),  # Melee\n    AttackOrArmor(class_=8, amount=6),   # Bonus vs Cavalry\n]\n\n# Armor\nhero.add_armour(class_=3, amount=4)  # Pierce\nhero.add_armour(class_=4, amount=6)  # Melee\n\n# Cost\nhero.cost.food = 80\nhero.cost.gold = 100\n\n# Training\nhero.creatable.train_time = 25\nhero.creatable.train_location_id = 82  # Stable\n\n# Graphics and sounds\nattack_gfx = gm.add_graphic(\"hero_attack.slp\", frame_count=15)\nhero.combat.attack_graphic = attack_gfx.id\n\nattack_snd = sm.add_sound(\"hero_attack.wav\")\nhero.bird.attack_sound = attack_snd.id\n\n# Save\nworkspace.save(\"output.dat\")\nprint(f\"Created {hero.name} at ID {hero.id}\")\n</code></pre>"},{"location":"api/units/unit-manager/","title":"GenieUnitManager","text":"<p>The <code>GenieUnitManager</code> class handles unit CRUD operations: create, clone, move, and retrieve units.</p>"},{"location":"api/units/unit-manager/#getting-the-manager","title":"Getting the Manager","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\num = workspace.genie_unit_manager()\n</code></pre>"},{"location":"api/units/unit-manager/#methods","title":"Methods","text":""},{"location":"api/units/unit-manager/#create","title":"create()","text":"<p>Create a new unit by cloning from an existing template.</p> <pre><code>def create(\n    name: str,\n    base_unit_id: Optional[int] = None,\n    unit_id: Optional[int] = None,\n    enable_for_civs: Optional[List[int]] = None,\n    on_conflict: Literal[\"error\", \"overwrite\"] = \"error\",\n    fill_gaps: Literal[\"error\", \"placeholder\"] = \"placeholder\",\n) -&gt; UnitHandle\n</code></pre> Parameter Type Description <code>name</code> <code>str</code> Name for the new unit <code>base_unit_id</code> <code>int</code> Unit to clone from. <code>None</code> = first valid unit <code>unit_id</code> <code>int</code> Target ID. <code>None</code> = auto-assign next available <code>enable_for_civs</code> <code>List[int]</code> Civ IDs to enable. <code>None</code> = all civs <code>on_conflict</code> <code>str</code> <code>\"error\"</code> or <code>\"overwrite\"</code> if ID exists <code>fill_gaps</code> <code>str</code> <code>\"error\"</code> or <code>\"placeholder\"</code> for gaps"},{"location":"api/units/unit-manager/#examples","title":"Examples","text":"<pre><code># Basic creation (auto-assigns ID)\nunit = um.create(\"My Archer\", base_unit_id=4)\nprint(f\"Created at ID {unit.id}\")\n\n# Create at specific ID\nhero = um.create(\"Hero\", base_unit_id=38, unit_id=1500)\n\n# Overwrite if exists\num.create(\"Replacement\", base_unit_id=4, unit_id=100, on_conflict=\"overwrite\")\n\n# Enable only for specific civs\num.create(\"Britons Archer\", base_unit_id=4, enable_for_civs=[1])  # Britons only\n</code></pre>"},{"location":"api/units/unit-manager/#clone_into","title":"clone_into()","text":"<p>Clone an existing unit to a specific destination ID.</p> <pre><code>def clone_into(\n    dest_unit_id: int,\n    base_unit_id: int,\n    name: Optional[str] = None,\n    enable_for_civs: Optional[List[int]] = None,\n    on_conflict: Literal[\"error\", \"overwrite\"] = \"error\",\n    fill_gaps: Literal[\"error\", \"placeholder\"] = \"placeholder\",\n) -&gt; UnitHandle\n</code></pre> Parameter Type Description <code>dest_unit_id</code> <code>int</code> Target unit ID for the clone <code>base_unit_id</code> <code>int</code> Source unit ID to clone from <code>name</code> <code>str</code> Name for clone. <code>None</code> = keep original name <code>enable_for_civs</code> <code>List[int]</code> Civ IDs. <code>None</code> = all civs <code>on_conflict</code> <code>str</code> <code>\"error\"</code> or <code>\"overwrite\"</code> <code>fill_gaps</code> <code>str</code> <code>\"error\"</code> or <code>\"placeholder\"</code>"},{"location":"api/units/unit-manager/#examples_1","title":"Examples","text":"<pre><code># Clone Archer to ID 2000\nclone = um.clone_into(dest_unit_id=2000, base_unit_id=4, name=\"Archer Copy\")\n\n# Clone without renaming\num.clone_into(dest_unit_id=2001, base_unit_id=4)  # Keeps \"Archer\" name\n\n# Overwrite existing\num.clone_into(dest_unit_id=100, base_unit_id=4, on_conflict=\"overwrite\")\n</code></pre>"},{"location":"api/units/unit-manager/#move","title":"move()","text":"<p>Move a unit from one ID to another.</p> <pre><code>def move(\n    src_unit_id: int,\n    dst_unit_id: int,\n    on_conflict: Literal[\"error\", \"overwrite\", \"swap\"] = \"error\",\n    fill_gaps: Literal[\"error\", \"placeholder\"] = \"placeholder\",\n) -&gt; None\n</code></pre> Parameter Type Description <code>src_unit_id</code> <code>int</code> Source unit ID <code>dst_unit_id</code> <code>int</code> Destination unit ID <code>on_conflict</code> <code>str</code> <code>\"error\"</code>, <code>\"overwrite\"</code>, or <code>\"swap\"</code> <code>fill_gaps</code> <code>str</code> <code>\"error\"</code> or <code>\"placeholder\"</code> <p>Placeholder at Source</p> <p>After moving, the source ID contains a placeholder unit (not <code>None</code>) to maintain table integrity.</p>"},{"location":"api/units/unit-manager/#examples_2","title":"Examples","text":"<pre><code># Move unit 100 to ID 2000\num.move(src_unit_id=100, dst_unit_id=2000)\n\n# Overwrite destination\num.move(src_unit_id=100, dst_unit_id=200, on_conflict=\"overwrite\")\n\n# Swap two units\num.move(src_unit_id=100, dst_unit_id=200, on_conflict=\"swap\")\n</code></pre>"},{"location":"api/units/unit-manager/#get","title":"get()","text":"<p>Get a handle for an existing unit.</p> <pre><code>def get(unit_id: int, civ_ids: Optional[List[int]] = None) -&gt; UnitHandle\n</code></pre> Parameter Type Description <code>unit_id</code> <code>int</code> The unit ID to retrieve <code>civ_ids</code> <code>List[int]</code> Civ IDs to include. <code>None</code> = all"},{"location":"api/units/unit-manager/#examples_3","title":"Examples","text":"<pre><code># Get unit for all civs\narcher = um.get(4)\n\n# Get for specific civs only\nbritons_archer = um.get(4, civ_ids=[1])  # Only Britons\n</code></pre>"},{"location":"api/units/unit-manager/#exists","title":"exists()","text":"<p>Check if a unit ID exists (excludes placeholders).</p> <pre><code>def exists(unit_id: int) -&gt; bool\n</code></pre>"},{"location":"api/units/unit-manager/#example","title":"Example","text":"<pre><code>if um.exists(1500):\n    unit = um.get(1500)\nelse:\n    unit = um.create(\"New Unit\", base_unit_id=4, unit_id=1500)\n</code></pre>"},{"location":"api/units/unit-manager/#count","title":"count()","text":"<p>Return total number of unit slots.</p> <pre><code>def count() -&gt; int\n</code></pre>"},{"location":"api/units/unit-manager/#example_1","title":"Example","text":"<pre><code>print(f\"Total unit slots: {um.count()}\")\n</code></pre>"},{"location":"api/units/unit-manager/#conflict-handling","title":"Conflict Handling","text":"<p>When creating or moving units, conflicts can occur if the target ID already exists.</p> Mode Behavior <code>\"error\"</code> Raises <code>UnitIdConflictError</code> <code>\"overwrite\"</code> Replaces existing unit <code>\"swap\"</code> Exchanges source and destination (move only) <pre><code># Safe creation with error handling\ntry:\n    unit = um.create(\"Test\", base_unit_id=4, unit_id=100)\nexcept UnitIdConflictError:\n    print(\"ID 100 already exists!\")\n    unit = um.get(100)\n</code></pre>"},{"location":"api/units/unit-manager/#gap-filling","title":"Gap Filling","text":"<p>When creating units at IDs beyond current capacity, gaps may need to be filled.</p> Mode Behavior <code>\"placeholder\"</code> Fills gaps with disabled placeholder units <code>\"error\"</code> Raises <code>GapNotAllowedError</code> <p>Placeholders are detected by: <code>enabled=0</code>, <code>name=\"\"</code>, <code>hit_points=1</code></p> <pre><code># This will fill IDs up to 5000 with placeholders\num.create(\"Far Unit\", base_unit_id=4, unit_id=5000, fill_gaps=\"placeholder\")\n</code></pre>"},{"location":"api/units/unit-manager/#complete-example","title":"Complete Example","text":"<pre><code>from Actual_Tools import GenieWorkspace\nfrom Actual_Tools.exceptions import UnitIdConflictError\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\num = workspace.genie_unit_manager()\n\n# Check current count\nprint(f\"Current unit count: {um.count()}\")\n\n# Create a series of heroes\nfor i in range(3):\n    unit_id = 2900 + i\n\n    if um.exists(unit_id):\n        print(f\"ID {unit_id} exists, overwriting...\")\n\n    hero = um.create(\n        name=f\"Hero {i+1}\",\n        base_unit_id=38,\n        unit_id=unit_id,\n        on_conflict=\"overwrite\",\n    )\n    hero.hit_points = 150 + (i * 50)\n    print(f\"Created {hero.name} at ID {hero.id} with {hero.hit_points} HP\")\n\n# Clone one hero\nclone = um.clone_into(dest_unit_id=2910, base_unit_id=2900, name=\"Hero Clone\")\nprint(f\"Cloned to {clone.name} at ID {clone.id}\")\n\n# Move a unit\num.move(src_unit_id=2900, dst_unit_id=2920, on_conflict=\"overwrite\")\nprint(\"Moved Hero 1 to ID 2920\")\n\nworkspace.save(\"output.dat\")\n</code></pre>"},{"location":"api/units/wrappers/","title":"Unit Wrappers","text":"<p>Wrappers provide organized access to unit sub-components. Each wrapper groups related properties and propagates changes across all civilizations.</p>"},{"location":"api/units/wrappers/#how-wrappers-work","title":"How Wrappers Work","text":"<pre><code>unit = um.get(4)  # Archer\n\n# Access wrapper\ncombat = unit.combat  # Returns Type50Wrapper\n\n# Read property\nprint(combat.max_range)  # 5.0\n\n# Write property (applies to all civs)\ncombat.max_range = 7.0\n</code></pre>"},{"location":"api/units/wrappers/#type50wrapper-combat","title":"Type50Wrapper (Combat)","text":"<p>Access via: <code>unit.combat</code></p> <p>Controls attack statistics, damage, and armor.</p>"},{"location":"api/units/wrappers/#properties","title":"Properties","text":"Property Type Description <code>max_range</code> <code>float</code> Maximum attack range <code>min_range</code> <code>float</code> Minimum attack range <code>reload_time</code> <code>float</code> Attack cooldown <code>accuracy_percent</code> <code>int</code> Accuracy (0-100) <code>blast_width</code> <code>float</code> Splash damage radius <code>blast_damage</code> <code>float</code> Splash damage amount <code>attack_graphic</code> <code>int</code> Attack animation ID <code>attack_graphic_2</code> <code>int</code> Secondary attack graphic <code>projectile_unit_id</code> <code>int</code> Projectile unit ID <code>displayed_attack</code> <code>int</code> UI displayed attack <code>displayed_range</code> <code>float</code> UI displayed range <code>base_armor</code> <code>int</code> Base armor value <code>attacks</code> <code>list</code> Attack entries (read-only) <code>armours</code> <code>list</code> Armor entries (read-only)"},{"location":"api/units/wrappers/#example","title":"Example","text":"<pre><code>unit = um.get(4)  # Archer\n\n# Increase range\nunit.combat.max_range = 7.0\nunit.combat.displayed_range = 7.0\n\n# Faster attack\nunit.combat.reload_time = 1.5\n\n# Better accuracy\nunit.combat.accuracy_percent = 90\n\n# Add splash damage\nunit.combat.blast_width = 0.5\nunit.combat.blast_damage = 2.0\n</code></pre>"},{"location":"api/units/wrappers/#creatablewrapper-training","title":"CreatableWrapper (Training)","text":"<p>Access via: <code>unit.creatable</code></p> <p>Controls training time, location, and costs.</p>"},{"location":"api/units/wrappers/#properties_1","title":"Properties","text":"Property Type Description <code>train_time</code> <code>int</code> Training time in seconds <code>train_location_id</code> <code>int</code> Building ID where trained <code>button_id</code> <code>int</code> Button position (1-15) <code>rear_attack_modifier</code> <code>float</code> Rear attack bonus <code>flank_attack_modifier</code> <code>float</code> Flank attack bonus <code>hero_mode</code> <code>int</code> Hero flag <code>resource_costs</code> <code>tuple</code> Cost tuple (use CostWrapper)"},{"location":"api/units/wrappers/#example_1","title":"Example","text":"<pre><code>unit = um.get(4)\n\n# Training settings\nunit.creatable.train_time = 20\nunit.creatable.train_location_id = 12  # Archery Range\nunit.creatable.button_id = 1\n</code></pre>"},{"location":"api/units/wrappers/#costwrapper-resources","title":"CostWrapper (Resources)","text":"<p>Access via: <code>unit.cost</code></p> <p>Convenience wrapper for resource costs.</p>"},{"location":"api/units/wrappers/#properties_2","title":"Properties","text":"Property Type Description <code>food</code> <code>int</code> Food cost <code>wood</code> <code>int</code> Wood cost <code>gold</code> <code>int</code> Gold cost <code>stone</code> <code>int</code> Stone cost"},{"location":"api/units/wrappers/#example_2","title":"Example","text":"<pre><code>unit = um.get(4)\n\n# Set costs\nunit.cost.food = 0\nunit.cost.wood = 25\nunit.cost.gold = 45\nunit.cost.stone = 0\n\n# Or set individually\nunit.cost.gold = 50\n</code></pre>"},{"location":"api/units/wrappers/#birdwrapper-movement-tasks","title":"BirdWrapper (Movement &amp; Tasks)","text":"<p>Access via: <code>unit.bird</code></p> <p>Controls movement, sounds, and task management.</p>"},{"location":"api/units/wrappers/#properties_3","title":"Properties","text":"Property Type Description <code>move_sound</code> <code>int</code> Movement sound ID <code>attack_sound</code> <code>int</code> Attack sound ID <code>work_rate</code> <code>float</code> Gathering/work rate <code>search_radius</code> <code>float</code> Search range <code>drop_sites</code> <code>list</code> Drop site building IDs <code>default_task_id</code> <code>int</code> Default task <code>tasks</code> <code>TasksWrapper</code> Task collection"},{"location":"api/units/wrappers/#example_3","title":"Example","text":"<pre><code>unit = um.get(83)  # Villager\n\n# Sounds\nunit.bird.move_sound = 5\nunit.bird.attack_sound = 6\n\n# Work rate\nunit.bird.work_rate = 0.45\n\n# Drop sites\nunit.bird.drop_sites = [109, 68]  # Town Center, Mill\n</code></pre>"},{"location":"api/units/wrappers/#taskswrapper-commands","title":"TasksWrapper (Commands)","text":"<p>Access via: <code>unit.tasks</code> or <code>unit.bird.tasks</code></p> <p>Manages unit task/command collection.</p>"},{"location":"api/units/wrappers/#methods","title":"Methods","text":"Method Returns Description <code>add_task(...)</code> <code>None</code> Add new task <code>list_tasks()</code> <code>List[Task]</code> Get all tasks <code>get_task(task_id)</code> <code>Task</code> Get by ID <code>remove_task(task_id)</code> <code>bool</code> Remove by ID <code>copy_task(task_id)</code> <code>None</code> Copy existing task <code>clear_tasks()</code> <code>None</code> Remove all"},{"location":"api/units/wrappers/#add_task-parameters","title":"add_task Parameters","text":"Parameter Type Description <code>task_type</code> <code>int</code> Task type (see Datasets.Task) <code>id</code> <code>int</code> Task ID <code>resource_in</code> <code>int</code> Input resource type <code>resource_out</code> <code>int</code> Output resource type <code>work_value_1</code> <code>float</code> Work amount <code>work_range</code> <code>float</code> Work range <code>working_graphic_id</code> <code>int</code> Animation while working <code>enabled</code> <code>int</code> 1=enabled, 0=disabled"},{"location":"api/units/wrappers/#example_4","title":"Example","text":"<pre><code>from Datasets import Task, Resource\n\nunit = um.get(83)  # Villager\n\n# List current tasks\nfor task in unit.tasks.list_tasks():\n    print(f\"Task {task.id}: type={task.task_type}\")\n\n# Add gather task\nunit.tasks.add_task(\n    task_type=Task.GATHER,\n    id=100,\n    resource_in=Resource.GOLD,\n    resource_out=Resource.GOLD,\n    work_value_1=0.4,\n    work_range=0.5,\n)\n\n# Remove a task\nunit.tasks.remove_task(task_id=3)\n</code></pre>"},{"location":"api/units/wrappers/#resourcestorageswrapper","title":"ResourceStoragesWrapper","text":"<p>Access via: <code>unit.resource_storages</code></p> <p>Manages resource carrying capacity.</p>"},{"location":"api/units/wrappers/#methods_1","title":"Methods","text":"Method Description <code>resource_1(type, amount, flag)</code> Set slot 1 <code>resource_2(type, amount, flag)</code> Set slot 2 <code>resource_3(type, amount, flag)</code> Set slot 3 <code>get(slot)</code> Get storage slot <code>set(slot, type, amount, flag)</code> Set any slot"},{"location":"api/units/wrappers/#flags-storemode","title":"Flags (StoreMode)","text":"Flag Description <code>0</code> No change <code>1</code> Keep resource <code>2</code> Give resource on death"},{"location":"api/units/wrappers/#example_5","title":"Example","text":"<pre><code>from Datasets import Resource, StoreMode\n\nsheep = um.get(594)\n\n# Sheep carries 100 food, gives on death\nsheep.resource_storages.resource_1(\n    type=Resource.FOOD,\n    amount=100.0,\n    flag=StoreMode.GIVE_ONLY\n)\n</code></pre>"},{"location":"api/units/wrappers/#buildingwrapper","title":"BuildingWrapper","text":"<p>Access via: <code>unit.building</code></p> <p>Controls building-specific properties.</p>"},{"location":"api/units/wrappers/#properties_4","title":"Properties","text":"Property Type Description <code>construction_graphic</code> <code>int</code> Building animation <code>snow_graphic</code> <code>int</code> Snow variant <code>garrison_type</code> <code>int</code> What can garrison <code>garrison_heal_rate</code> <code>float</code> Heal rate inside <code>tech_id</code> <code>int</code> Associated tech <code>construction_sound</code> <code>int</code> Build sound <code>transform_unit</code> <code>int</code> Transform into <code>pile_unit</code> <code>int</code> Rubble unit"},{"location":"api/units/wrappers/#example_6","title":"Example","text":"<pre><code>building = um.get(12)  # Barracks\n\n# Garrison settings\nbuilding.building.garrison_type = 15  # All military\nbuilding.building.garrison_heal_rate = 0.5\n\n# Construction\nbuilding.building.construction_sound = 100\n</code></pre>"},{"location":"api/units/wrappers/#damagegraphicswrapper","title":"DamageGraphicsWrapper","text":"<p>Access via: <code>unit.damage_graphics</code></p> <p>Manages visual damage states.</p>"},{"location":"api/units/wrappers/#methods_2","title":"Methods","text":"Method Description <code>add_damage_graphic(graphic_id, damage_percent, apply_mode)</code> Add state <code>remove_damage_graphic(index)</code> Remove by index"},{"location":"api/units/wrappers/#example_7","title":"Example","text":"<pre><code>building = um.get(12)\n\n# Add 50% damage state\nbuilding.damage_graphics.add_damage_graphic(\n    graphic_id=450,\n    damage_percent=50,\n)\n\n# Add 25% damage state  \nbuilding.damage_graphics.add_damage_graphic(\n    graphic_id=451,\n    damage_percent=25,\n)\n</code></pre>"},{"location":"api/units/wrappers/#projectilewrapper","title":"ProjectileWrapper","text":"<p>Access via: <code>unit.projectile</code></p> <p>Controls projectile behavior (for arrow/projectile units).</p>"},{"location":"api/units/wrappers/#properties_5","title":"Properties","text":"Property Type Description <code>projectile_type</code> <code>int</code> Projectile type <code>smart_mode</code> <code>int</code> Smart targeting <code>hit_mode</code> <code>int</code> Hit detection mode <code>vanish_mode</code> <code>int</code> Disappear mode <code>projectile_arc</code> <code>float</code> Arc height"},{"location":"api/units/wrappers/#example_8","title":"Example","text":"<pre><code>arrow = um.get(359)  # Arrow unit\n\narrow.projectile.projectile_arc = 0.5\narrow.projectile.smart_mode = 1\n</code></pre>"},{"location":"api/units/wrappers/#deadfishwrapper","title":"DeadFishWrapper","text":"<p>Access via: <code>unit.dead_fish</code></p> <p>Controls movement graphics and rotation.</p>"},{"location":"api/units/wrappers/#properties_6","title":"Properties","text":"Property Type Description <code>walking_graphic</code> <code>int</code> Walk animation <code>running_graphic</code> <code>int</code> Run animation <code>rotation_speed</code> <code>float</code> Turn speed <code>turn_radius</code> <code>float</code> Turn radius"},{"location":"api/units/wrappers/#example_9","title":"Example","text":"<pre><code>unit = um.get(4)\n\nunit.dead_fish.rotation_speed = 0.5\nunit.dead_fish.turn_radius = 0.0\n</code></pre>"},{"location":"examples/graphics/","title":"Graphics Examples","text":"<p>Real-world examples for graphics and delta manipulation.</p>"},{"location":"examples/graphics/#create-unit-graphics-set","title":"Create Unit Graphics Set","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\ngm = workspace.graphic_manager()\num = workspace.genie_unit_manager()\n\n# Create graphics for a hero unit\nidle = gm.add_graphic(\"hero_idle.slp\", frame_count=10, angle_count=8)\nwalk = gm.add_graphic(\"hero_walk.slp\", frame_count=15, angle_count=8)\nattack = gm.add_graphic(\"hero_attack.slp\", frame_count=12, angle_count=8)\ndeath = gm.add_graphic(\"hero_death.slp\", frame_count=20, angle_count=8)\n\n# Configure animation speeds\nidle.frame_duration = 0.1\nwalk.frame_duration = 0.07\nattack.frame_duration = 0.06  # Fast attack\ndeath.frame_duration = 0.08\n\n# Assign to unit\nhero = um.create(\"Hero\", base_unit_id=38)\nhero.standing_graphic = idle.id\nhero.dead_fish.walking_graphic = walk.id\nhero.combat.attack_graphic = attack.id\nhero.dying_graphic = death.id\n\nworkspace.save(\"output.dat\")\n</code></pre>"},{"location":"examples/graphics/#add-shadows-to-graphics","title":"Add Shadows to Graphics","text":"<pre><code># Find shadow graphic\nshadow = gm.find_by_name(\"SHADOW_CAVALRY\")\nif not shadow:\n    shadow = gm.find_by_file_name(\"shadow.slp\")\n\n# Add shadow to multiple graphics\ngraphics_to_shadow = [idle, walk, attack, death]\n\nfor gfx in graphics_to_shadow:\n    if shadow:\n        gfx.add_delta(\n            graphic_id=shadow.id,\n            offset_x=0,\n            offset_y=4,\n        )\n        print(f\"Added shadow to graphic {gfx.id}\")\n</code></pre>"},{"location":"examples/graphics/#create-weapon-effects","title":"Create Weapon Effects","text":"<pre><code># Weapon flash effect (only on front angles)\nflash = gm.find_by_name(\"WEAPON_FLASH\")\n\nif flash:\n    # Add to attack graphic for front-facing angles\n    attack.add_delta(\n        graphic_id=flash.id,\n        offset_x=8,\n        offset_y=-5,\n        display_angle=0,  # Front\n    )\n    attack.add_delta(\n        graphic_id=flash.id,\n        offset_x=6,\n        offset_y=-5,\n        display_angle=1,  # Front-right\n    )\n    attack.add_delta(\n        graphic_id=flash.id,\n        offset_x=-6,\n        offset_y=-5,\n        display_angle=7,  # Front-left\n    )\n</code></pre>"},{"location":"examples/graphics/#copy-and-modify-graphics","title":"Copy and Modify Graphics","text":"<pre><code># Find original graphic\noriginal = gm.find_by_name(\"KNIGHT_ATTACK\")\n\nif original:\n    # Copy it\n    modified = gm.copy(source_id=original.id)\n    modified.name = \"HERO_KNIGHT_ATTACK\"\n\n    # Speed up animation\n    modified.speed_multiplier = 1.3\n    modified.frame_duration = 0.05\n\n    # Add sound\n    modified.sound_id = 50\n\n    print(f\"Created modified graphic at ID {modified.id}\")\n</code></pre>"},{"location":"examples/graphics/#damage-state-graphics","title":"Damage State Graphics","text":"<pre><code># Create damage graphics for building\nbarracks = um.get(12)\n\n# At 50% damage\nbarracks.add_damage_graphic(graphic_id=450, damage_percent=50)\n\n# At 25% damage (more visible damage)\nbarracks.add_damage_graphic(graphic_id=451, damage_percent=25)\n\n# Near destruction\nbarracks.add_damage_graphic(graphic_id=452, damage_percent=10)\n</code></pre>"},{"location":"examples/graphics/#managing-deltas","title":"Managing Deltas","text":""},{"location":"examples/graphics/#list-all-deltas","title":"List All Deltas","text":"<pre><code>gfx = gm.get(100)\n\nprint(f\"Graphic {gfx.id} has {len(gfx.deltas)} deltas:\")\nfor i, d in enumerate(gfx.deltas):\n    print(f\"  [{i}] graphic={d.graphic_id}, offset=({d.offset_x}, {d.offset_y}), angle={d.display_angle}\")\n</code></pre>"},{"location":"examples/graphics/#remove-specific-delta","title":"Remove Specific Delta","text":"<pre><code># Remove shadow (graphic ID 200)\nremoved = gfx.remove_delta_by_graphic(graphic_id=200)\nif removed:\n    print(\"Shadow removed\")\n</code></pre>"},{"location":"examples/graphics/#replace-delta-graphic","title":"Replace Delta Graphic","text":"<pre><code># Replace old shadow with new one\nfor delta in gfx.deltas:\n    if delta.graphic_id == 200:  # Old shadow\n        delta.graphic_id = 201   # New shadow\n</code></pre>"},{"location":"examples/graphics/#adjust-delta-positions","title":"Adjust Delta Positions","text":"<pre><code># Move all deltas down by 2 pixels\nfor delta in gfx.deltas:\n    delta.offset_y += 2\n</code></pre>"},{"location":"examples/graphics/#clipboard-operations","title":"Clipboard Operations","text":"<pre><code># Copy a nice graphic to clipboard\ngm.copy_to_clipboard(100)\n\n# Create variations\nfor i in range(5):\n    pasted = gm.paste()\n    pasted.name = f\"VARIATION_{i}\"\n    pasted.speed_multiplier = 1.0 + (i * 0.1)\n    print(f\"Created variation at ID {pasted.id}\")\n\ngm.clear_clipboard()\n</code></pre>"},{"location":"examples/graphics/#complete-example-hero-with-full-graphics","title":"Complete Example: Hero with Full Graphics","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\ngm = workspace.graphic_manager()\num = workspace.genie_unit_manager()\n\n# Find existing components\nshadow = gm.find_by_name(\"SHADOW_CAVALRY\")\nflame = gm.find_by_name(\"FLAME_SMALL\")\n\n# Create graphics\nidle = gm.add_graphic(\"hero_idle.slp\", frame_count=10, angle_count=8)\nwalk = gm.add_graphic(\"hero_walk.slp\", frame_count=15, angle_count=8)\nattack = gm.add_graphic(\"hero_attack.slp\", frame_count=12, angle_count=8)\n\n# Configure timing\nfor gfx in [idle, walk, attack]:\n    gfx.frame_duration = 0.07\n\n    # Add shadow\n    if shadow:\n        gfx.add_delta(graphic_id=shadow.id, offset_y=3)\n\n# Add flame effect to attack\nif flame:\n    attack.add_delta(\n        graphic_id=flame.id,\n        offset_x=0,\n        offset_y=-12,\n        display_angle=-1,  # All angles\n    )\n\n# Create unit\nhero = um.create(\"Flame Knight\", base_unit_id=38)\nhero.standing_graphic = idle.id\nhero.dead_fish.walking_graphic = walk.id\nhero.combat.attack_graphic = attack.id\nhero.hit_points = 200\n\nworkspace.save(\"output.dat\")\n\n# Summary\nprint(f\"\\nCreated Flame Knight (ID {hero.id})\")\nprint(f\"  Idle graphic: {idle.id} ({len(idle.deltas)} deltas)\")\nprint(f\"  Walk graphic: {walk.id} ({len(walk.deltas)} deltas)\")\nprint(f\"  Attack graphic: {attack.id} ({len(attack.deltas)} deltas)\")\n</code></pre>"},{"location":"examples/units/","title":"Unit Examples","text":"<p>Real-world examples for unit manipulation.</p>"},{"location":"examples/units/#create-a-hero-unit","title":"Create a Hero Unit","text":"<pre><code>from Actual_Tools import GenieWorkspace\nfrom Datasets import UnitClass\nfrom genieutils.unit import AttackOrArmor\n\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\num = workspace.genie_unit_manager()\ngm = workspace.graphic_manager()\nsm = workspace.sound_manager()\n\n# Create hero from Knight\nhero = um.create(\"Champion Knight\", base_unit_id=38)\n\n# Stats\nhero.hit_points = 250\nhero.speed = 1.6\nhero.line_of_sight = 6\nhero.class_ = UnitClass.CAVALRY\n\n# Combat\nhero.combat.max_range = 0\nhero.combat.reload_time = 1.8\n\n# Attacks\nhero.attacks = [\n    AttackOrArmor(class_=4, amount=18),  # Melee\n    AttackOrArmor(class_=8, amount=8),   # Bonus vs Cavalry\n]\n\n# Armor\nhero.add_armour(class_=3, amount=4)  # Pierce\nhero.add_armour(class_=4, amount=6)  # Melee\n\n# Cost\nhero.cost.food = 100\nhero.cost.gold = 120\n\n# Training\nhero.creatable.train_time = 20\nhero.creatable.train_location_id = 82  # Stable\n\nworkspace.save(\"output.dat\")\nprint(f\"Created {hero.name} at ID {hero.id}\")\n</code></pre>"},{"location":"examples/units/#create-a-custom-archer","title":"Create a Custom Archer","text":"<pre><code># Create enhanced archer\narcher = um.create(\"Elite Crossbowman\", base_unit_id=24)  # Crossbowman\n\n# Range buffs\narcher.combat.max_range = 8.0\narcher.combat.min_range = 0.0\narcher.combat.accuracy_percent = 95\n\n# Attack\narcher.set_attack(class_=3, amount=10)  # Pierce damage\n\n# Armor\narcher.set_armour(class_=3, amount=2)\n\n# Cost\narcher.cost.wood = 35\narcher.cost.gold = 50\n\nprint(f\"Created {archer.name}\")\n</code></pre>"},{"location":"examples/units/#modify-existing-unit","title":"Modify Existing Unit","text":"<pre><code># Get existing Militia\nmilitia = um.get(74)\n\n# Buff stats\nmilitia.hit_points += 20\nmilitia.speed = 1.1\nmilitia.combat.reload_time = 1.5\n\n# Add bonus vs buildings\nmilitia.add_attack(class_=11, amount=5)\n\nprint(f\"Modified {militia.name}\")\n</code></pre>"},{"location":"examples/units/#create-unit-series","title":"Create Unit Series","text":"<pre><code>base_hp = 100\n\nfor i in range(3):\n    unit = um.create(\n        name=f\"Soldier {i+1}\",\n        base_unit_id=74,  # Militia\n        on_conflict=\"overwrite\",\n    )\n    unit.hit_points = base_hp + (i * 30)\n    unit.cost.food = 50 + (i * 10)\n    print(f\"Created {unit.name} with {unit.hit_points} HP\")\n</code></pre>"},{"location":"examples/units/#clone-and-modify","title":"Clone and Modify","text":"<pre><code># Clone Knight to new ID\nclone = um.clone_into(\n    dest_unit_id=2500,\n    base_unit_id=38,\n    name=\"Knight Elite\",\n)\n\n# Enhance\nclone.hit_points = int(clone.hit_points * 1.5)\nclone.speed *= 1.1\n\nprint(f\"Cloned to {clone.name} at ID {clone.id}\")\n</code></pre>"},{"location":"examples/units/#create-gatherer-unit","title":"Create Gatherer Unit","text":"<pre><code>from Datasets import Task, Resource\n\n# Create villager variant\ngatherer = um.create(\"Super Villager\", base_unit_id=83)\n\n# Faster work\ngatherer.bird.work_rate = 0.6\ngatherer.bird.search_radius = 10\n\n# Add gather task\ngatherer.tasks.add_task(\n    task_type=Task.GATHER,\n    resource_in=Resource.FOOD,\n    resource_out=Resource.FOOD,\n    work_value_1=0.5,\n    work_range=0.5,\n)\n\n# Drop sites\ngatherer.bird.drop_sites = [109, 68, 562]  # TC, Mill, Folwark\n</code></pre>"},{"location":"examples/units/#building-with-garrison","title":"Building with Garrison","text":"<pre><code># Create custom barracks\nbarracks = um.create(\"Fortress Barracks\", base_unit_id=12)\n\n# Garrison settings\nbarracks.building.garrison_type = 15\nbarracks.garrison_capacity = 15\nbarracks.building.garrison_heal_rate = 0.5\n\n# HP\nbarracks.hit_points = 2500\n</code></pre>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#requirements","title":"Requirements","text":"<ul> <li>Python 3.11 or higher</li> <li>genieutils-py (auto-installed)</li> </ul>"},{"location":"getting-started/installation/#install-from-pypi","title":"Install from PyPI","text":"<pre><code>pip install aoe2-genie-tooling\n</code></pre>"},{"location":"getting-started/installation/#install-from-source","title":"Install from Source","text":"<pre><code>git clone https://github.com/GoKuModder/aoe2-genie-tooling.git\ncd aoe2-genie-tooling\npip install -e .\n</code></pre>"},{"location":"getting-started/installation/#development-dependencies","title":"Development Dependencies","text":"<p>For contributing:</p> <pre><code>pip install -e \".[dev]\"\n</code></pre> <p>This includes: - <code>pytest</code> for testing - <code>ruff</code> for linting</p>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\nprint(\"aoe2-genie-tooling installed successfully!\")\n</code></pre>"},{"location":"getting-started/quickstart/","title":"Quick Start","text":"<p>Get up and running with aoe2-genie-tooling in 5 minutes.</p>"},{"location":"getting-started/quickstart/#loading-a-dat-file","title":"Loading a DAT File","text":"<pre><code>from Actual_Tools import GenieWorkspace\n\n# Load the DAT file\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\n\n# Get managers\num = workspace.genie_unit_manager()\ngm = workspace.graphic_manager()\nsm = workspace.sound_manager()\n</code></pre>"},{"location":"getting-started/quickstart/#creating-a-unit","title":"Creating a Unit","text":"<pre><code># Create a new unit (clones from Archer)\nhero = um.create(\"My Hero\", base_unit_id=4)\n\n# Modify properties\nhero.hit_points = 150\nhero.speed = 1.4\nhero.max_range = 6.0\n\n# Set costs\nhero.cost.food = 50\nhero.cost.gold = 75\n</code></pre>"},{"location":"getting-started/quickstart/#adding-attacks-and-armor","title":"Adding Attacks and Armor","text":"<pre><code>from genieutils.unit import AttackOrArmor\n\n# Add attacks\nhero.add_attack(class_=3, amount=8)   # Pierce\nhero.add_attack(class_=11, amount=3)  # Bonus vs Buildings\n\n# Add armor\nhero.add_armour(class_=3, amount=2)   # Pierce armor\nhero.add_armour(class_=4, amount=1)   # Melee armor\n\n# Or replace all attacks\nhero.attacks = [\n    AttackOrArmor(class_=3, amount=10),\n    AttackOrArmor(class_=4, amount=5),\n]\n</code></pre>"},{"location":"getting-started/quickstart/#creating-graphics","title":"Creating Graphics","text":"<pre><code># Create a new graphic\nattack_gfx = gm.add_graphic(\n    file_name=\"hero_attack.slp\",\n    frame_count=15,\n    angle_count=8,\n)\n\n# Assign to unit\nhero.combat.attack_graphic = attack_gfx.id\n</code></pre>"},{"location":"getting-started/quickstart/#creating-sounds","title":"Creating Sounds","text":"<pre><code># Create a new sound\nattack_snd = sm.add_sound(\"hero_attack.wav\")\n\n# Assign to unit\nhero.bird.attack_sound = attack_snd.id\n</code></pre>"},{"location":"getting-started/quickstart/#saving","title":"Saving","text":"<pre><code># Save the modified DAT file\nworkspace.save(\"output.dat\")\n\n# Export registry for AoE2ScenarioParser integration\nworkspace.save_registry(\"genie_edits.json\")\n</code></pre>"},{"location":"getting-started/quickstart/#complete-example","title":"Complete Example","text":"<pre><code>from Actual_Tools import GenieWorkspace\nfrom genieutils.unit import AttackOrArmor\n\n# Load\nworkspace = GenieWorkspace.load(\"empires2_x2_p1.dat\")\num = workspace.genie_unit_manager()\ngm = workspace.graphic_manager()\n\n# Create unit\nhero = um.create(\"Champion\", base_unit_id=38)  # Knight clone\nhero.hit_points = 200\nhero.speed = 1.5\n\n# Combat stats\nhero.combat.max_range = 0\nhero.combat.reload_time = 1.8\n\n# Attacks\nhero.attacks = [\n    AttackOrArmor(class_=4, amount=15),   # Melee\n    AttackOrArmor(class_=8, amount=8),    # Bonus vs Cavalry\n]\n\n# Cost\nhero.cost.food = 80\nhero.cost.gold = 100\n\n# Save\nworkspace.save(\"output.dat\")\nprint(f\"Created {hero.name} at ID {hero.id}\")\n</code></pre>"},{"location":"getting-started/quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Units API \u2013 Complete unit manipulation guide</li> <li>Graphics API \u2013 Graphics and deltas</li> <li>Unit Examples \u2013 Real-world examples</li> </ul>"}]}